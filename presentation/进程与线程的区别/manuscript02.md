今天我们来讲一道经典的面试题，进程和线程的区别？



为了讲清楚这道面试题，我们首先了解一些基础概念，包括计算机的组成和并行与并发，然后聊一些程序、进程、线程的关系，最后系统的总结进程与线程的区别。



我们都知道，计算机由硬件部分和软件部分组成，硬件部分包括cpu、内存、硬盘，软件部分包括操作系统，用户通过计算机软件部分，也就是操作系统，操控计算机硬件部分。cpu是计算机最核心的部件，承担所有的计算任务。内存用于暂时存储CPU运算的数据，以及和硬盘等外村设备交换的数据，不能断电保存。硬盘是计算机中的存储设备，保存在硬盘上的数据断电后也可以保存。操作系统是计算机的管理者，负责任务的调度，资源的分配和管理，统领整个计算机硬件部分。



讲完计算机组成，我们来看一下并行与并发，我们首先来看一下什么是并发，前面讲到，操作系统负责任务的调度，在大多数操作系统，如linux windows中，任务的调度是通过时间片轮转的抢占式调度方式，也就是一个任务在CPU中执行一小段时间后被强制暂停，然后CPU去执行下一个任务，多个任务轮流执行。任务执行的一小段时间被称为时间片，任务获得CPU时间片，被CPU调度并执行，此时任务处于运行状态，当CPU时间片用完，任务被强制暂替进入就绪状态，等待下一个属于自己的时间片到来。由于CPU计算速度非常快，每个时间片的时间间隔很短，CPU在多个任务之间快速切换，人感觉就好像多个任务在同时执行。实际上，任意一个时刻，只有一个任务在执行，这就是并发执行。



下面我们来看并行，前面讲的并发执行是单核CPU的情况，线程大多数计算机是多核计算机，处于同一个cpu核心的任务仍然是并发执行，但是处于不同cpu核心的任务执行相互不受影响，可以真正的同时运行，这就是并行。



程序是一组由编程语言编写的，计算机可以识别并允许的指令，通俗地来讲就是我们编写的代码。



进程是一个独立的具有一定功能的程序在数据集上的一次动态执行过程，是操作系统资源分配的最小单位。进程是一个抽象的概念，目前还没有一个统一的标准的定义，进程由程序、数据集合、进程控制块三部分组成。程序用于描述进程要完成的功能，是进程执行的指令集；数据集合是程序在执行时所需要的数据和工作区；进程控制块是Process Control Block，检查PCB，包含进程的描述信息和控制信息，是进程存在的唯一表示。



前面讲到任务的调度是通过时间片轮转的抢占式的调度方式，由于进程是操作系统资源分配的最小单位，每个进程都有独立的地址空间。在对进程进行创建、上下文切换、销毁时开销很大，为了解决这个问题，线程的概念被提出，线程是CPU调度和执行的最小单位。线程是真正去抢占时间片并在CPU中执行的。我们可以线程看作是进程的执行路径，进程可以有多条执行路径，即进程可以有多个线程，进程至少要有一条执行路径，即进程至少要有一个线程。进程有内存空间和一个或多个线程组成，内存空间包括程序、进程空间、数据、打开文件。线程有线程ID、寄存器、程序计数器、栈组成。



线程的声明周期



- 本质区别：进程是操作系统资源分配的最小单位。线程是CPU调度和执行的最小单位。

- 包含关系：一个进程至少有一个线程，线程是进程的一部分。
- 资源开销：每个进程都有独立的地址空间，进程之间切换会有比较大的开销；线程是比进程更小的抽象概念，同一个进程内的多个线程共享进程的地址空间，每个线程都有自己的独立运行栈和程序计数器，线程之间切开销比较小。
- 影响关系：一个进程崩溃后，在保护模式下，其他进程不会受到影响。一个线程崩溃后，整个进程都可能被操作系统杀掉。

7:45



8:22