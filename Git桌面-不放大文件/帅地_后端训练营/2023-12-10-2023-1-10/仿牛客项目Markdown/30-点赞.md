30-点赞.mp4

这次课我们来实现点赞的功能，那么点赞功能大家应该都非常熟悉，这是一个使用频率非常高的功能。那么如果一个大号他发了一篇文章，那么可能会吸引非常多的人给他点赞，所以说这个点赞功能我们开发的时候重点要考虑性能的问题，因为可能同时有很多人会给同一个帖子点赞，你要考虑到性能的问题。

因此像点赞这样产生的数据，我们最好把它存到 rise里，因为你把数据存到内存里性能会好很多，这是我们这个功能大概要注意的点，就是把数据存到readiness里来提升性能。

那么从这个功能上来说，我们的项目当中有两个地方可以支持点赞，一个是在这个帖子上你可以对帖子进行点赞，另外对于帖子的评论你也可以点赞，那么我们在点赞的时候，那么我点一下，如果他没有赞之前我没赞过，我点一下，那就是赞了，我已经赞了以后，我再点一下就把赞取消，是这样一个规则。

那么当我点完赞以后，功能开发完以后，我们还要做一些显示，那么首页上咱们不是有一个帖子列表，每一个帖子他一共被点了多少个赞，我们需要做一个显示。

另外我们帖子详情页面，然后也要统计帖子，他一共点了多少个赞，另外每一个评论有多少个赞，就是关于赞的数量的显示。

好了，那么接下来我们就来实现这个点赞的功能，那么我打开我的开发工具，然后按照我们之前长期开发养成的一个习惯，我们首先应该去写数据访问层，但是现在我们是要把数据存到 rides里，而存到rides里，其实就好像我们操作一个map一样，非常简单对吧？

然后因此数据访问层我们就不单独去写了，因为它太简单了，我们直接写业务层，那么在处理业务的过程中，那么你需要存数据直接调 ready sample的往里存就可以了，当然取也是同样的。

好，然后那么我们在像ready存数据取数据操作数据的过程中，那么它是以 k为关键的，我们是面向它的k去编程的，所以为了能够让 t反复的复用，然后的话比较容易记，那么我最好给 readiness写一个工具，专门的用来生成它 key，这样好复用，所以首先我先去写生成 red SK的工具，那么我在YouTube包下新建一个类，这个类我给它取名了叫。

ready tuto。

就是一个简单的工具，这个不需要由容器来管理，我们直接提供静态方法去访问就可以了。

然后我们的key都是中间是用冒号隔开的对吧？然后是由一个单词一个单词拼成的，那么我们在实际开发的时候，那么可能有些单词固定的，可能有些这个单词是你需要传入的，是动态的。

好，那么这样我首先先说明一个常量，就是用来拼 k的一部分的常量，时代的一个final，然后实际上我讲。

是贝类等于冒号。

那么我们所有的key在拼的时候，中间以冒号来分割各种单词，就用这个常量就可以了。

好，然后现在我们是要准备要存这个帖子或者是评论的赞对吧？

那帖子评论我们可以一起存，我们管帖子和评论我们统称为实体，我们要存实体的赞，我希望实体的赞他以某一个前缀来开头 t我也说明一个常量，也是stream，然后我叫这是一个前缀，后面还需要加上具体的帖子，可能加上ID什么的，这个是前缀，所以我叫price下划线。

 anti。

然后。

 like。

实体的赞， like就喜欢赞，然后我希望是以这样的前缀 like。

冒号。

and当然后面你可以再加冒号加其他的更明确的条件，反正这个是前缀。

好，有了条件以后，接下来我再写一个静态方法，然后要求你传入一些变量，我把它拼到长江上面去，最终得到一个完整的k好。这里我写个注释，我要生成的是某个实体的站，这样一个k某个实体的。

站。

因为它需要被外界访问，所以这个得是公有的，然后是静态的，然后返回的是一个kiss菌方法名，我叫get。

 Entity like he。

好，那么像这样一个t实体，你肯定得传入实体的相关的关键信息，而实体的关键信息不就是 tap和ID对吧？所以你应该把这个int太传进来。

 ittid传进来，实体类型和实体的ID传进来，传进来以后我们把这个前缀以及这两个变量拼到一起去，就形成了这样一个实体的key，然后这里我再说一下，我们以 key来存的时候我们怎么存呢？

或者说 key将来长成啥样，它是这样的，let安贴贴后面的话拼上 NTT太太，然后再拼上nttid最终拼成这样的一个形式，然后 k它所对应的值我用一个集合，而不是简单的一个整数。

当然我们存一个整数可以，你点了一次赞，整数就是一，你再点赞就是加一是可以的。

但是那么如果将来我们的需求发生变化，比如说我想看到到底谁给我占了，对吧？你这个时候存一个数字，可能这个需求就实现不了了。我这里我存的值用的是 site集合，而集合中我装的是什么？ User ID，谁给实体点的赞，我就把这个用户的ID存到集合里。那么当我们需要统计站的数量的时候，这个集合它会有统计数量的方法，对吧？然后如果将来我需要知道到底谁给我点了赞，那么这些每个用户ID我也能得到，所以我们这样存的话，那么能够最大程度地满足各种各样需求的变化，这个比较合适。

好了，既然我们了解了存的形式，那么这个地方我就这样写了，return我要return的是他，然后再加上失败类的，没有错了，加上冒号，然后再加上NTT type加上是贝类的，再加上安贴贴ID，那么我这样的方式不就是拼成了我想要的这个样子，对吧？

好了，那么我 key准备好了，准备 key的过程其实也是我们梳理我们要往release中如何存数据的这么一个过程。

那么梳理好以后，下面我们就可以开发我们业务组件了，那么这是一个新的业务，所以说我需要新建一个service，那么我在包下新建一个类叫lack。

 service站，当然我需要首先加上servis注解。

除此以外我们要把数据存到readiness里，所以说你需要注入 readiness template。

好。

那么接下来我就来实现了这个点赞的这个方法业务方法，这个方法public不需要返回值，只要不报错，反正就是点赞成功了，然后这个方法名我就叫那么需要几个参数，首先我加上uzid是谁点的赞，其次我加上 Entity tap点赞的实体是谁安全的ID也是实体的一部分，方法说明完以后实现其实比较容易，首先我们需要拼出来，我要存的数据的key，反正你要点赞，我要往 ready这里存，我要拼上 key的名字，我叫安贴。

贴赖

 t nttlkt然后等于red is key utu点get NTT like t那么你需要把NTT type ittid传入，那么我们就会得到这样一个k然后有了 k以后你注意我刚刚开始说的时候说我们第一次点赞，那是如果我再次点赞，就是取消这个赞对吧？

所以你还得判断一下我当前用户点没点过赞对吧？那么如果点过了我要取消，如果没点过我要点就是我要存这个数据，具体怎么判断？因为我们最终存的是集合里，存的是uzid所以你判断一下 Uzid在不在集合里，就知道你点没点过赞了，对吧？这个很容易能够想到，所以我首先判断一下它在不在集合里，那么我就 ready stand play的点ops form sad for sad，然后可以调这个意思，it's number这个方法。

然后当然我需要传入 key NTT like key，然后传入你要判断的是哪一个值，是优质ID。好，那么这句话执行完以后我会得到一个布尔值，我先把它记录下来。布尔值就是is number。

好。

然后我判断一下。

如果说。

返回数，那就证明说我已经点过赞了，这个时候我就需要取消赞，那就是把uzid从集合中删除掉对吧？那也很容易 Ready，template。点ops for sat，然后点remove。Remove，然后 t是on TT来k删除的是uzid行了。

然后。

否则那就是uzid不在这个集合里，就是我没点过赞的，我要添加这个数据。

好。点爱的，然后把 t写上去，然后 uzid存进去，好了，这个就可以了。

好，这个点赞方法我就实现完了，但是你还要注意我们不只是要点赞，后续还要统计点赞的数量，并且我们在详情页上不只是要统计数量，我们还要显示点赞的状态，你是你没有赞这里就显示赞这个字，如果你已经赞过了，这里要显示已赞，所以说你要根据点赞状态，你是否点过赞来显示这个字，因此我们还需要把统计数量统计点赞的状态这个方法也写出来，好，为后面的功能做一个准备，这里我就一起写了。

那么我再增加一个方法就是查询实体点赞的数量，查询了某实体点赞的数量。

那么。

这个方法就返回的是浪。然后这个方法名儿我叫find an ticket like come。

好，因为你查的是某一个实体的数量，所以说你肯定是要把实体这两个值传进来。

好，那么传进来以后我们无非就是看 T对应的值，里边有几个u在ID有就是几个数量，所以也需要用 key把这个代码粘过来，粘过来以后我就直接return就行了，return read this template，点UPS，fall，sad。

然后统计数量 size，然后你把 k传进去，我们就能够统计到 k所对应的集合里边的数据的数量，这非常简单了。好，除了这个以外还要统计实体的点赞的状态，某个人给实体点没点过赞，就查询某人对某实体的点赞状态有没有点过赞。好，那么这个其实从我们的需求上来说，我们返回一个布尔值就可以了，对吧？数据点过放似就没点过，但是这里我返回的是整数，为什么呢？是因为将来还有可能，比如说将来业务扩展了，我们可能还不只是点赞，还可以点个彩，你布尔值就表现不出第三种状态，而我用整数的话，这三种状态就都能表现，对吧？

所以它更具备扩展性，我返回整数。

好，那么这个方法名儿我叫find anti like status我要查询的是点赞状态，是某人得把这个人要传进来，又做ID，然后某实体安贴的相关的条件你要传进来。好，那么传进来以后你判断是不是点过赞也很容易，其实就调刚才这个is number就可以了，对吧？当然首先你得有 Key，把 key copy以后我就 return read。

 this。

 template ok as for the foresight，然后 is its member，然后的话是 key Entity，leg，key，然后 use ID当然 is number返回布尔值，那么如果它返回true，我就把它转成整数，显示为一，否则就是零。

也就是说如果我返回一表示说你点了赞，返回0表示说你没点赞，如果将来我们要开发点彩，你可以返回-1，这样就很清楚好了，目前这个业务方法就这么几个方法我们就实现了，实现以后接下来我们就来处理表现层，表现层我们这个点赞是在帖子详情页面去点，点的时候这个是异步请求，整个页面不刷新，然后点完以后根据返回的条件，你动态的改变一下，这个字就可以了，或者改变一下赞的数量就可以了。

不用整体刷新，页面效率高一点。

好这样我再新建一个来CTRL，好，然后这里边我要把莱克斯维斯注入进来，因为我要调用这个点赞的业务对吧？

好把like service注入进来，然后谁点赞是当前的用户点赞，为了得到当前的用户，我把 House偷的注入进来，好注入这两个变，然后我需要写一个能够处理义务请求的方法，先说明这个这个方法的路径，我就叫like，然后 MR的等于post，因为你点赞你要传入一些信息进来，所以这个是post。

好，然后因为是异步请求，所以我需要再加上另外的注解 response，response body，那么说明这个方法我返回死卷，然后名字就叫当你点赞的时候，你是针对某一个实体点的，所以你肯定得把实体传进来，那就是因 mtt太以及 NTT ID。

好了，那么因为是当前的用户进行一个点赞，所以我首先先获取当前用户。

好，那么取到以后我们要点赞，你就调这个like service，当然有人说你是不是要判断一下用户，他有没有登录，其实我这里不判断也行，那么我们不是用拦截器可以去判断某一个功能，他有没有登录，登录以后才能访问，我们不是做了这样的事情，所以你可以通过拦截一下，不登录不让访问就可以了，这个你自己去实现。

再一个那么将来其实我们会采用 spring security对于这样的方法进行一个重构，对这样的对拦截器进行重构，然后的话用 security安全模块统一管理，这样的权限问题。所以说我先放我这里，我就不用去判断这个变量它有没有值了。我们之前会有一个拦截。好，那么下面我就要实现点赞了。

那。

就调 like service，点like方法，你把这个参数传进去就行了，这就点赞了，那么点赞完以后你要统计这个点赞的数量以及点赞的状态，把它返回到页面上，根据你的反馈值好去做数量和状态的一些显示。

那么这里我写上就是数量，先获取数量是个long，然后 Like count。

等于like service点，

find。

Count然后把这两个条件都传进去，好，这个数量就有了，那么再来除了数量以外，还有这个状态。

对。

状态是一个整数，我叫like斯德尔斯，那么我需要传输优质ID，我需要传入就uzid得这样讲，悠着点get ID然后 idtcmidt ID。

好。

那么最终我需要把这两个值把它统一的传给页面，我需要把它封装一下，传这样零碎的不好传，我用map封装一下。

然后 new。

希map就 map点put，一个叫like count，然后再来 map put like status。好， Map写注释。

这是返回的结果，现在点赞也点了，结果也有了，最终我就返回一个阶层格式的数据就好了，对吧？我就 community YouTube点get Jason string调这个方法，然后正确返回0提示我，就返回now，然后把 Map数据返回给页面。

好了，这个CTRL咱们也写完了，写完以后接下来就是去处理页面的逻辑了，而这个点赞我们刚才也说了，是在帖子详情页面去点的，所以我们需要打开帖子详情页面进行一个处理。

好，我搜一下，帖子详情页面是disc os，detail点html，然后我从头往下找一找这个页面比较长，咱们慢慢看，但实际上这个页面上有三个地方能点赞，一个是对帖子点赞，一个是对那两种类型的评论进行点赞，一共有三个地方有点赞，我们一点点找，好，那么很快我就找到了这个地方，赞这个地方是对帖子进行点赞，然后这里边我得处理一下超链接，我点了一个超链接的时候去访问服务器，那么因为是异步请求，所以我们需要提供一个GS方法来实现。

就点赞的提交请求的逻辑，这个地方我这样写，我把 hres井号改成Java secret，冒号分号，比方说超链接，我不把它当做超链接来看，这里不是路径，这里我需要在超链接上写js，但是 js这里目前什么都没有。空的，好然后怎么办？我可以这样。

可立克我给它定一个单机事件，你点超链接超链接废了，但是这单机事件会触发的，说白了我就是把这个超链接当成一个按钮来用了，然后安克利克里边我要调一个GS方法，然后去发请求，那么这个方法当中因为我需要给他传一些条件进去，因此需要拼一些变量，所以说我在安克利克之前加上th为了拼变量，然后这个方法的名字是静态的，我就加双竖线方法名我叫烂，然后括号，然后以分号结束，这是整个方法的一个基本结构，那么这个方法我需要传几个参，首先我传个例子，类似代表的是当前你点这个节点就当前的超链接，为什么要传它？

因为我们整个页面上三有三个站点，这三个站中的任何一个他调的方法都是我们肯定不能写三个方法对吧？是复用同一个方法，我在这个方法里怎么区分你点的到底是哪个站，我是要区分的，因为你点了哪个站，我将来要改这个站后面的这个数对吧？

所以我得知道我把this传进去，就是为了知道当前你点的到底是哪个a这个意思。好，然后我们点赞你得传NTT tap nttid对吧？你当前是对帖子点赞，这个tap就是一逗号，mttid那就是帖子的ID对吧？那帖子ID这里写谁，你看这里取帖子是post，对吧？那去帖子ID我们就知道了，应该是这样写，post点ID。好这就可以了，我们一会要做的事情无非就是把这个like方法写一下就好了。

好，当然这里还得再稍微处理一下，就是说我调了这个方法，我向服务器发了请求，那么点了赞以后服务器会给我返回，数量我得改变一下这个值，他会给我返回状态，我得改变一下这个字对吧？

如果返回的状态是点了赞，这个字要变成已赞，返回的状态是没有赞，这个地方就只是显示赞，所以说为了便于说改这两个东西，我最好给这两个东西外面套上一个标签这样我好访问它，不然就不好访问了是吧？

这样这块有点长，我把它折个行，这样方便一点，然后赞11我也折个行，因为我需要加标签，我在账的外面再加一个b对不对？然后在11的外面我加一个a那么把它俩做一个区分，用标签我得到 A以后就很容易得到a的子节点b和I好，对他们加以修改。

好了，这是第一个站，我已经把这个单机事件的处理好了，另外的两个站你找到以后，那么处理方式是类似的。好，我往下找一下。

第二个站应该是在回帖列表当中有，然后第三个站是在回复里，这儿好这是第二个我把它处理一下，处理的方式也类似，这样我也换个行吧，那么我也是那样想知道吧？Secret冒号分号，然后这里边也要写上th，冒号 on，click等于然后 like括号，括号结束当前当前的节点传入this，当前我是对评论点赞它的类型是二对吧？

然后第三个参数是应该是评论的ID，那么评论数据怎么获得？你看前面参考一下 Cvo.comment对吧？你能够获取到创新时间，ID就是类似的就是点ID就可以了。好，然后赞这个字和一这个数我们也需要改，我在它外面也是套上b和I执行相同的逻辑，

把一外面套个a好，这是第二个赞。最后一个在这儿也做一个换行处理好，我就不啰嗦了，按照刚才的方式去做。

那么这个地方我们取的是回复的ID，而这个回复你看前面rvo点replay这不就是回复对吧？ I他的苦于他们这样去idea。

那就是点ID。

就是replay，点ID就可以了。同理这地方也是做一样的处理，套上一个b套上一个a好了，那么三这三个超链接我都处理完了，处理完以后我需要写这个like方法。

我看一下我当前的页面它依赖了哪些js文件，我在哪个里写比较合适，它只依赖了 global点js，Globo是全局的，任何网页都引用的，我们在这里也不太合适，所以我们就单独创建一个GS， copy一下，那么我创建一个新的js文件，因为当前是帖子详情页面 GS。

我叫。

 discourse点GS好，那么接下来我就在static GS目录下新建一个js文件， discuss点js，那么在这个文件里我就需要写 like方法，这个方法很好写， function like。按照刚才我们所写，我们需要传入三个参，第一个参代表超链接，但是超链接我是把它当成按钮来用了，所以说我给它取名叫button按钮。

那么第二个参我们传进来的是实体的ID，安不是实体的类型，NTT太对吧？第三个是nttid那么都传进来以后，我们要向服务器发送一个异步请求，对这个数据加以处理，那就到了点，这是一个post，请求我要提交数据的，那么首先我需要写上路径康txt，加上这是我们这个功能的访问路径。

然后第二个是携带参数，首先携带intet type，好，然后再携带 mttid。

好，那么接下来我们处理返回的数据， data，对于返回的这个字符串，我们需要把它转成GS对象，到了点儿pass Jason data。

那么有了对象以后，我们做一个判断，如果data点儿扣的等于0，就比方说我这次请求是成功的。

否则那。

就是失败了，失败了我就直接弹出一个提示就完了。

那就right。

data点message。

当然我们失败的是统一处理的，我们通过控制器通知统一处理的成功的话，我们需要怎么做？我们需要改变，找一下站，我们需要改变站的这里面的数量，我们还要改这个字，是占还是已占？

好，你看我们不是传进来了当前你点的按钮吗？那么我就可以通过这个按钮得到它下级的 B标签和这个I标签它的子节点，然后去改变它的值是吧？我先改这个数量，我就到了8天，我先获取8天节点，然后获取它的子节点，children它的子节点的标签名是I显示数量的，然后我想在 I里改变它的值，改变它的内容点text，这个内容是什么？是我们data返回的数据， Data点like count就可以了是吧？

另外还要改那个状态，那也是类似的。8点点丘疹显示那个字的标签是b B的内容，text b的内容我们得看一下data点like status。如果like status一如果它等于一，比方说我赞成功了对吧？我赞成功了，我这里要显示什么？我就要显示已赞，否则它不等于一，那就是没成功怎么办？我就显示。站就你可以去站好了， Js文件我也写完了，到这我们可以测一下，看一下我们到那个页面上点能不能起作用，我把这个项目重新启动一下。

好，服务器启动完以后咱们来测一下。

Look，host，先访问首页，当然我这里需要登录一下，登录以后当然我们现在首页上赞的数量都是假的，我随便找一个帖子，比如说就玄学帖，这个也是假的，我先不管他，先我点一下，点赞以后他成功了，显示成已赞了对吧？

然后再点一下，再点一下以后就取消了，取消以后赞的数量都变成0了，我再点一下已赞。

好，那么比如说我再点一个评论，别点评论，这个没有反应，我们看一下是服务端报错了，还是说前端报错了，我们看一下。

首先服务端没报错，我们看一下前端的逻辑，看看页面上有没有报错，页面上报错了，那么它提示我，你看它有提示说cvo is not defined，cvo未定义可能是我调那个方法是条件写错了，我看一下 cvo这个是rvo前面这个是 CPU确实写错了，因为你这里取的是一个变量对吧？你得加上dollar，对吧？不然这样写的不对 Dollar，这rl是不是也写错了，看一下这也是写错了。

好忘记了，我重新编译一下，编译以后再打开页面，我刷新一下，刷新以后这个状态显示的就不对了，因为什么？我们只是点完以后动态的改它的值，但是我们访问详情页面默认它它就是显示一个固定的值，我们只要没点没触发它，这个值就不变，所以这块显示上还有问题，我们一会再处理。

然后这里我再点一下一个赞，点赞又变成已赞了，点赞表明可以了，那么数据对不对？我们也可以去 Reads里看一下。

然后。

我先看一下kiss，我们那个点赞的key是以 like开头的，你看有了这么几个数据，包括你看 e开头的就是帖子对吧？二开头的这是这个评论没有问题，我们不是一共点了一个帖子的赞，我们一共点了三个评论的赞，对吧？

一共4条数据。没错好了，那么这个点赞实现了，现在欠缺的是首页上我赞的数量显示的不对是吧？然后帖子打开的时候，那我们查看的时候，数量和站的状态显示的不对，这里我们需要对这个显示进行一个处理。

首先我们先处理首页站的数量的显示，这样我要打开 home controller，因为我是在这里，显示的是这个帖子列表的，那么我们在查询帖子的过程中，我们可以在查询的过程中去查一下这个帖子有多少个赞。

我在这儿补充一个逻辑，在这儿加上查询站的数量，我需要把 like service注进来好，那么注入以后这个地方要查了long like。

 count等于like。

 service点。Find Entity。Like count。然后那么我们查的是帖子的账，所以这个tap应该是一，但我别写死一，我还是引用常量。

好，这个地方我就可以写成on TT type post对吧？第二个是实体ID，帖子ID帖子ID，帖子ID是多少？就是post点get ID对吧？赞的数量就有了以后我把它装到 Map里，页面上就能得到了是吧？就map点put like counter。好，那么完成以后这就可以了，我们打开首页，那么找到显示站的地方，然后把它处理一下，搜一下。Index html。

好，我找一下，这是在帖子列表里，这儿回帖数量我们已经显示了，站的数量我们需要做处理，我希望在11外面套上一个标签，套上一个死蛋，然后死伴之上我要获取数据，那就th冒号，然后是txt等于一个变量，这个变量我从map里取对吧？Map。

第二let好。

写。

完以后编译，然后打开浏览器试一下，刷新一下你看这回所有的帖子它占的数量都是0，只有赞的数量是一，这个帖子不就我们给了一个赞对吧？这就对了。

好，最后还要处理一下帖子详情页面，它显示赞的数量以及状态，我们需要对加以处理，而帖子详情页面我们是在discuss post control里做的请求的处理。 Detail请求对吧？好，这里因为你要查的是站的相关的消息，我还是要把max注入进来。好，我看一下它有没有实现接口实现了。好，我回到 Detail这个方法对它进行处理。那么首先我们要查这个帖子的赞，这里我查到了帖子的作者，帖子的作者，后面再补充一个就是赞点赞有关的信息。

首先是来一个数量like。

 count。

等于 like service点，find Entity like account。那么帖子实体是一，然后 Id是帖子ID，参数上有。好，那么这个值我要把它传给页面，我就model点ID like count。

好。

那么不只是有点赞数量，还得有这个状态对吧？我分开写点赞数量，

点赞状态就是。

我当前用户是否对这个帖子点过赞，那我们得到的是一个整数。

我。

调用like service Find like find on the next datas去查询，那么查询的时候我需要先传入用户的ID是当前的用户的ID，当前用户我这里有没有house头的？

有。那就house偷点get use点刚才的，然后帖子它的类型是，然后帖子ID是好，同样我需要把这个状态发给页面猫，都有点艾特 like status，那么这个地方我们在实现的时候还要考虑这样一点就是说这个帖子和帖子详情页面，其实如果用户不登录他也能够访问，如果没有登录的时候，你是不是这个值就取不到，这值就会报控制人异常，你这样写。

所以说这个地方还要再做一层判断，如果你没有登录，那么点赞状态就返回0，就比方说你没赞过，你都登录都没登录，肯定也就相当于你没赞过对吧？你没有身份，否则我们再去查询，所以这块我们得稍微再判断一下，我再处理一下。 Household点get user，如果它等于now表示说它就没登录，我就直接返回0了，否则我再去做这样一个查询，好。这个地方做这样一个处理。严谨一点。

这是对于帖子的点赞的相关的数据的查询，那么对于这个评论也需要做类似的处理，所以我把这个代码拷贝了一下。然后看这是有评论的作者，我们需要对评论增加这样的数据，我在这做一个补充。好，那么点赞数量复用这个变量，所以说前面就不用声明这个类型了， like count，然后等于like service点 find的时候，这个时候你是查评论，是吧？这个地方就不要写成post而写成comment，然后你这里要传的是评论的ID，评论的ID你可以从 comment里取对吧？

要get ID。好，那么这个数量我要把它不是直接用猫的发送，而是把它放到存到 vo comment vo里，这地方要处理 comment vo，然后点 put。

 like count。

这是点赞的数量，那么点赞的状态是类似的，首先也是做一个判断，那么没有登录返回0，那么否则我就登录了我就去查，那么查的时候又在ID没问题，然后这个是评论的类型，然后应该是评论的ID，那么同样的这个状态，我们是要把它装到vo里， comment will点put好了，这是关于评论的点赞的信息，那么还有回复，回复的处理就也是类似的。

好，那么我们在这查到了回复的数据作者以及回复的目标，对吧？那么后面再补充一个关于点赞就可以了。好，那么我们再过一遍，看看有什么地方需要改动。首先点赞数量 Find这个类型是 comment没有问题，然后 ID是回复的，ID而回复是replay对吧？是replay，运费点开台d然后我们把 like count要放到replay video里，对吧？不是comment vo了，名字没问题。

好，再看到点赞的状态，也是做这样的一个判断，然后这样的查询类型是comment，然后 ID应该是replay点get ID，好，那么这个状态也是放到replay video当中去是吧？

好了，那么到这儿我们关于这三三三个地方，这个点赞的数据就查到了，都把它放到了相应的对象里头去。

那么最后我们再回到帖子详情页面，然后的话我们找到那三个点赞的地方，然后把它的默认就打开页面默认显示的数据给它设置好就可以了，我打开帖子详情页面，我们从头开始过一遍就那三个地方。

首先是帖子，这儿这个地方先看这个数量，先显示数量，数量你要显示的就是我们刚才CTRL的时候查的来个com变量， th冒号text等于你看我怎么返回的这个地方，我就直接存的是like count，是吧？所以你就写。

 like come就行了。

好，然后关于赞，我们也需要做一个处理， th冒号，text等于我需要看状态。

 like status。

它是否等于一，如果它等于一，我这里要显示。

你在对吧？

否则我就只显示在。

好了，那么。

点赞的数量和这个状态我就显示好了，那么另外两个位置它的处理方式和雷同了，我们再找一下第二个，这是第二个。

然后下面三第二个， I上面我要写th冒号text。

等于我记得刚才我写的是我把 like com存到了vo里，而这个vo就是 cvo对吧？Cvo like count。好，那么赞的状态也是类似 th冒号 text。那么等于CV o点like。standards它等于一吗？等于一，显示已占。否则显示在好。这是第二个。

那么第三个在这儿处理方式和刚才是一样的，首先我们还是先处理数量，pH冒号，txt等于 Like count，我是从 replay队伍里取，从 rvo里取的对吧？

Rvo rvo点like com，

然后点赞的状态 th text等于 rvo like。Status一吗？等于一显示已在，否则显示在。

好了。

那么到这儿，这三个就是点赞的地方，我们把它打开页面以后的初始的值和状态也做了一个设置，下面我们重新编译，然后访问一下这个页面，看看有没有问题，好，我刷新一下首页，我当前是以CC的身份登录的，然后就这个帖子有赞我就点进去，已赞对吧？没有问题。

好这样我把它退出一下，退出以后点首页还点帖子，那么数量还是111没问题，但是因为我当前没有身份，所以这个状态显示的就是赞，而不是已赞，说明状态数量都是ok的。好了，那么这次课我们就把这个点赞的功能给它实现了，那么这个功能它的核心是我们对 readiness它的使用，巩固一下对release的使用。那么这次课我们就演示到这里，咱们下次课再见。