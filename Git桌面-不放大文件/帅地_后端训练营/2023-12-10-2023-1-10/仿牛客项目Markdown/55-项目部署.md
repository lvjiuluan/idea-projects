55-项目部署.mp4

项目打个包，然后部署到应用服务器上去。当然了我的应用服务器选的还是 Tom cat，它和我们之前所使用的汤派的是有区别的。我们之前用的是spring布的，它内嵌的汤派的，而这个是一个正常的普通的一个Tom cat，不是内嵌的。

 Tom cat它是一个应用服务器，它是一个软件，它需要装在硬件之上，这里我选择的硬件是阿里云的云服务器，然后配置是我选的是2核的CPU，4G的内存，这个系统的版本是三头s7.6，那么如果你想尝试的话，你也可以去购买这种云服务，或者是你自己在本机搭一个虚拟机也可以，但是要注意的是系统版本的问题不无所谓，问题不大，主要是配置内存不能小于4个g如果小于4个g的话，我们装的这些东西就跑不起来了，这是一个最低的配置的要求。

好了，然后我通过这个图主要是想给你展现一下，我们一会儿部署的时候要干的要干这个活，我们要装哪些东西，这些东西之间是一个什么关系，我把它给你理清楚，直观的呈现给你，这样的话我一会装你不至于说乱了，我们随时保持一个比较清醒的思路，那么在云服务器上我需要装这些东西，首先有 NDS那么它负责分发请求，浏览器访问的是ndx而不是直接访问Tom cat，为什么要这样做呢？

其实这个Angel就是Tom cat的相当于一个代理，我们通常称之为反向代理，那么怎么说，如果是正向代理指的是他代理的是浏览器，反向代理指的是代理的是服务器，你要访问服务器，必须通过ndx访问，那么将来如果说我 Tom cat部署多个节点， ndx可以平均的把请求分发到某一个节点之上，对吧？

如果说没有ndx你直接提供了三个Tom cat，你说我访问哪一个就就很混乱对吧？Ndx能够起到这样一个分流的作用，好，所以要装ndx然后装 Tom cat。

 Tom cat它本身是一个用Java开发的一个服务器，它自身的运行就需要依赖于GRE再一个它里面运行的是Java程序，也需要GRE，所以说我们在此之前还得把 GRE装好，掌握运行环境。

然后我还要装一个maven， maven的话主要是用来编译打包的，为什么在服务器上装没问呢？

就是说我希望在服务器上打包程序，我们写的源码发给服务器，服务器打包，然后再把它放到摊开的之下，有人可能会想你为什么没有在你本机上打好包，然后传到这个服务器上来有两点原因，第一个如果我在服务器上打包的话，这个打的包里边会包含所有我们依赖的账，这个会很大的会有一两百兆，那么你在本地把打好的包传给这个服务器，那就比较慢了，当时间这是第一个。

第二个还有可能我们本地的电脑有一些环境和应用服务器有可能有区别，比如说我本地装的是jdk12，这里边装的是GRE假设是11或者假设是13，那么万一有这样的差异的话，你本地打好的包在这上运行可能会有一些问题，而你在服务器上直接编译打包，肯定就是能够直接在这上运行起来，出于这么两点的考虑，所以服务器上装一个没问用来打包程序。

然后我们的应用依赖于这么多个工具，包括my circle，red is卡夫卡elastic search，还有 wkhtml图PDF这工具，那么这些工具是他们开的，在运行的时候会去调用他们的，我们都要一次把它装好。

当然了我一会装的时候并不会说严格的按照我刚才所说的顺序来装，反正按照我习惯的顺序，或者说按照他们依赖的顺序去装，那就一会再说了，总之要装这些东西。

然后这里我想说一下，就是说我们现在是在教学学习阶段，那么我们所拥有的服务器资源是非常有限的，我只有一个阿里云的服务器，所以说他只能装这些东西，如果是一个真实的生产环境的话，其实很多个工具是可以部署多个实例的， tomcat可以部署多个实例，数据库可以多个实例 release，卡夫卡几乎每一个工具都可以部署多个实例，让它处理能力更强，并发能力更好。

但是同样的你要梳理多部署多个实例，很显然你一台服务器就不够了，你得好几台服务器，我们学习的时候不方便，没有那么多资源怎么办？我们就每一个应用每一个应用只部署一个节点，只部署一个实例，所以说我们做的是一个比较单一的这么一个体系这样的。

好，然后我要把这些应用装到阿里云服务器上去的话，我需要有一个工具能够访问阿里云服务器，其实访问这个就是Linux系统的客户端有很多，这里我用的是免费的铺垫，用它来访问云服务器，然后去操作服务器装东西，这样好了，大概介绍到这以后我们知道要干什么了，以及我所做这件事的环境知道了，接下来我就开始安装这些东西，我们先安装，安装完以后我们再去对代码稍作调整，然后把它部署上去运行起来。

好，首先我需要安装铺贴，因为我要访问这个服务器，得先把它装好，铺贴它的官方网站是铺贴一点org打开以后比较简陋，然后的话你点这儿可以下载，然后这儿就是 Windows的版本，安装的工具，那么你可以我选的是64位的，我这里已经提前下载好，并且我都已经装好了，为什么这个工具不给你演示安装呢？

因为就是双击，然后下一步一路默认就完了，这里没有任何的一个需要注意的，特别的细节，默认安装一路下去就可以了，所以我提前装好了，然后装好以后我先启动一下，然后访问服务器看一下，给你看一下这工具就它然后这里我之前已经就访问过，所以说它有一个记录120.55.53.217，这就是我所购买的阿里云的服务器的IP地址，然后默认端口是22这样。

当然了，如果你要是做了域名解析的话，你将一个域名绑定到 IP地址上，你通过域名也可以访问我这里，我没有买域名，没有做域名解析，所以说只能通过这个IP来访问了，你就把这个IP当域名也可以。好，然后别着急再点一下 Connection，然后这个地方改成10，如果你不改10的话，可能是你连上这个服务器，然后你稍微过了一小会儿，没有动作它就断开了，改成10以后它很久也不断开这个意思。

好，然后 open以后他说了log in as，你以什么样的身份去登录这个服务器？

 Root就是最高级别的身份 root用户，然后这是密码，这密码是我通过工具随机生成的，我也记不住会copy，然后到这怎么粘贴过来，你可以按键盘seat加insert，这里它没有任何显示，但是你 safety insert以后回车，这就登录上来了，好，那么我把窗口变大一点，我现在就连上了这个服务器了，连上以后接下来要做的事情就是刚才我PPT上所展现的，我要装这些东西。

那么装这些东西我再多说两句，因为我用的是sent os这个版本，所以我们安装的时候优先采用亚母命令来安装，因为亚母命令我们装的时候它很方便，也非常稳定，通常不会有问题，而且装完以后它会自动的配置好环境变量，自动安装好启动的服务，所以说它一切都是自动的，只要一个命令就什么都装好了，你都不用手动去配，很方便，但是它有一个缺点就是亚母命令它一般给你下载的工具的版本稍微旧一点，不过有些工具稍微旧一点也无所谓，也正常能用，所以说我们能用这个命令就用这个命令，那么要么命令它是从一个中央服务器去下载安装工具，这个服务器就像没问的服务器一样，它是汇集了所有经过大量测试的稳定的版本让你去下载去安装的，没有经过测试的不稳定的版本是不会在这里出现的，所以它安装的工具一定是非常稳定的，有这样一个好处。

好，那么总之第一个原则就是我能用要么安装的，我就用命令安装。

第二个那么有一些工具它这个样的库文件实在是太旧了，但我想用一个比较新的，然后恰好这个软件它的官网又提供了亚马仓库的更新的文件，我可以把这个文件下载到服务器上，然后我把这个库文件先装一下，这样的话我就可以用亚母去装新版本的软件。

你比如说my circle就是这样的，就默认要么仓库带的马赛克版本比较低，我从它官网下载一个仓库文件把它安装好，这样的话就可以用亚马逊装一个新的my circle，这样比较方便，因为my circle要是你要配相关的服务的好，

我刚才所说的库文件，我们从my circle的官网上怎么去下载，我给你看一下，因为之前没有讲过这个环节。

这是my circle官网，my circle.com，然后你可以点 download，准备下载，然后你看这有一排下载什么东西，我要下的是什么 young repost，样仓库的资源点，它点了以后，这里边它就默认了，就是下载最高版本的文件，这里面提供了几个链接，分别是针对不同的操作系统的，那三台os我要选选然后点 download以后，然后点这就是我要下载就可以了，但你这是下载到本地，我如果说我想在服务器上下载，我需要的是这个地址怎么办？

你可以右键复制一个链接地址，然后在服务器上通过这个地址来下载就可以了。

好，所以如果说这个软件我能用要么安装，但是版本较低，我去看一下它的官网有没有对应的仓库的下载，有的话我就还是用这种方式先下载库文件，然后有一些软件它是不支持用亚麻安装的，仓库里没有这个文件，这个时候怎么办？我们就别用样了，我们就去它的官网下载针对Linux的安装包，是后缀是踏点gz的安装包。

好，这里我举个例子，比如说没稳，我们之前在windows下我们是下载安装过，如果是我要在Linux安装没稳，我应该下载哪个版本，我们看一下梅文点阿帕奇点org然后点左侧的download，然后后面之前我们windows上不是下载 zip对吧？你现在是 Linux下载 tar点gz这个包，当然我们需要做的是右键复制这个链接的地址，然后在我们的服务器上通过命令把它下载到服务器就可以了。

然后我们课程里还有别的工具也是类似的逻辑，你要去官网下载包，但是那些工具我就不挨个给你演示官网了，演示怎么去下载的，因为我们上课的时候都你告诉过你卡夫卡官网是什么对吧？

以来txt官网是什么，然后怎么去下载，告诉你怎么找过，那你找到那个界面，只不过换一个包而已，我相信大家都能够搞定好了。

以上是我们在服务器安装这些软件的时候，我所建议的原则，就是能用要么就用，要么不能要么就下载安装包，然后有些工具我们需要手动配置一下，那就手动配置一下。

接下来我给你演示一下，比如说我要在服务器上下载一个工具，比如说没问我应该怎么去下载，刚才我不是已经把 maven的链接已经复制了一下，我回到这个客户端它连的是这个服务器了。

好我要把这个软件下到哪，我就CD到目录下，CD到其实我当前就在 root目录下，我就在这里，目前其实有一些内容就是我提前下载好的，我课堂上我刚才说了在哪去下载这些资源，大概怎么下载，然后具体我课上就不去给你演示一个下载了，因为很费时间的，然后现在我只是做一个示例，说我要下载怎么办？做一个示例，这样我先创建一个test文件夹，然后我CD到test目录之下，现在什么都没有，我在这我要把美文的包下到这里来，我给你演示一下。

非常简单， W get杠a杠c然后把刚才的路径拷贝过来，你可以右键粘贴或者是 safe的加insert粘贴都可以。好，这就是我刚才复制的没文的下载的路径，然后回车。当然了这需要等一会 maven的包还算比较小，现在还算比较快，所以我用他的给你演示，其他的包就不是这样的。好我们等一会下载完了，我们再往后继续。

好了，这就下载完了，你可以看一下当前的目录，确实有这个文件，但其实我不需要，其实我之前都已经下载好了，你看上一级 root目录已经有了，没问的包，我只是给你做一个演示。

另外像这个一类是txt，还有它的中文分词的插件，还有卡夫卡，这几个文件我也已经提前下载好了。我他们的官网在哪，之前我上课讲过，所以说你自己去找。然后买circle的库文件，刚才我说过，我也已经提前下载好了，一会就不再重新下载了。另外还有 Tom cat之前我们用的是内嵌的版本，没有去单独下载它。 Tom cat我也下载好了，在哪下载，我告诉你这个地方它的官网是 Tom cat点阿帕奇点org，然后你点左侧的 download登录的里边有一个选择一个版本，你可以选择一个9最高的版本。

好，然后踏gz现在这个就可以了。

好，总之这些我们课上一会要安装所需要的这些包，我都提前下载好了，不在这个范围之内的，就说明我要用arm去安装，就不需要下载包。

好，那么做好了这些准备工作以后，我还要做一件事，我们不只是要从官网上下载一些资源，我们也可能需要从我们本地向这个服务器传一些东西，你比如说我们初始化数据库的脚本，以内的circle点GIP要传进来，对不对？

然后的话我们项目的源码最终是要传进来，是这样的，我们如何从本地往服务器上传一个文件，我明天给大家演示一下，首先我先找一个文件，好，我就找这个文件，肯定那些盈利的circle，就是我们初始化数据库的文件，好我要传的话把它压缩一下，压缩成一个GIP文件怎么传，我需要通过本地的命令行，我打开命令行，然后找到这个路径， CD到d盘work之下，然后看一下就 GIP文件，然后传的话是用命令 ps CP pscp然后的话写上你要传的文件的名字，我这个文件的名字叫 community in it circle点接IP。

好，然后你要传给哪个服务器，这里我写root at，然后 IP地址120点55点53.217，root表示说我要以root用户的身份往这个服务器上传东西，后面跟的是这个服务器的IP地址，然后的话冒号，后面斜线跟的是你要把它传到哪个路径下，我是要放到root test目录之下，好，写完命令以后回车，这时候他要求你填写入他的密码，好，还得考虑一下，回车，然后很快就传过去了。

这个时候我回到铺顶，回到这个服务器上，然后我看一下 CD到root，test目录下看一下有了，所以说我们本地的资源是这样传过来的， tot这工具怎么用，大概我们就了解了好了，做好这些准备以后，接下来我们就开始安装刚才我所说的这些东西。

那么在安装这些东西之前，我们还要安装一个小的工具，是一个解压缩的工具叫安工具，因为什么？你看我们本地往这个服务器上传的文件，我们是压缩成zip的包，这个包我们得用安zip来工具来解压缩，而我系统下默认没有这个工具怎么办？我们可以用 Em的方式来安装。

好然后在root下不要用去要么去搜资源，搜不到我CD到根路径下，然后我搜一下一样类似的去一样的库里搜一下资源，这个命令叫an z然后星比如说以an z开头的资源，我都要搜一下回车，很快就收到了，就一个按这个点 x86-64复制一下，你可以右键复制或者是CTRL加insert，复制完以后用这个样去装一下一样，然后的话is大杠y杠y的意思是说你在安装的过程中，如果需要我选择是和否一律帮我选成是好，然后把刚才的名字粘过来，然后回车，然后稍等一会儿，很快就装好了，这就可以了，一会儿我们会用到，反正现在装好了。

好接下来我们就安装 PPT上所展现的这些工具了，首先要装什么呢？装 GRE，因为我们大部分的工具都依赖于它，所以我先装 GRE，我也是搜一下erm list，Java星你需要以Java开头来搜，它叫Java什么，然后一下搜了一大堆的东西，有很多个版本，1.6开始到1~11，然后后面还有一个 latest，我要用的 latest就最新的版本也就是12号，我就把这个copy一下， let it open jdk x86-64就它好，然后采用要么命令把它装一下一样，instead跟刚才那个一样，然后杠y把这个名字粘贴过来，可以了，然后推车。

好需要稍等，因为我们只是访问了库，要从库里下载资源才能安装，这需要一点时间，不过还好比较快。那么装完以后你可以试一下12瓦word，就可以直接用版本是12没有问题。那就是说我们用arm去装工具以后，他帮我们已经把该配的东西都配好了，我就可以直接拿来用了，很方便。

好那么GRE装好以后再来装maven， Maven的话不能用arm装，我们必须通过踏包来装，而这个包我已经下载好了，我CD到root目录下看一下就是它了。

通常我们会把安装程序放到opt的目录下，所以说我只要把包解压缩到obt下面就可以了，这是一个套文件，所以用套命令来解压缩套杠zvxf然后的话阿帕奇 maybe什么然后杠c斜线opt回车。

好，这就解压完了，解压完以后你去看一下 CD到opt下，看一下有这个文件，我进去 CD到美版的目录下，然后 pwd我要看一下当前的路径，绝对路径是opt阿帕奇每本3.6.1，我把它copy一下，为什么要copy？因为我要配环境变量，因为我们是用解压缩的方式把它解压缩到一个目录下，但是系统是识别不了它的命令的。我为了用方便我给它配个核心变量。

么Linux系统下环境变量的配置方式有好几种，我只讲一个比较常用的，我们它把这个环境变量配到etc profile目录下， Etc文件夹profile目录下，我就用 vim工具 etc profile，然后放到其实我们要配的这个pass本来就有一些值，它就包含了一些参数，我现在需要把每本也追加到 pass目录的，后面怎么追加，我在这儿安一下。

插入模式，然后的话写上export，然后大写的pass等于dollar pass，dollar pass代表的是pass原本的值，然后后面冒号， pass拼的时候，它每一段中间用冒号隔开，冒号，然后粘贴过来我刚才拷贝的路径。

那意思是说我要把pass原有的值后面加上冒号，每晚的路径拼在一起，做成一个新的值，再写回到pass变量里 pass就被更新了，就这样好。然后那就保存一下，打到q保存一下，保存完以后现在还没生效，我们需要再通过命令让文件生效一下，让配置生效一下。

Source provide我写错了，少写个 source，profile这就生效了，我们可以这回可以打印出 pass变量，看一下它有没有维稳的路径，用一口命令来打印，pass到了pass，你看后面有维稳，这就可以了，到这你可以测一下每本高word，你看他说command not found，这个命令不存在，但我没写错，没文章我怎么写错，为啥不存在？

我仔细一看这块配错了，我们配的是命令存在的目录，其实是阿帕奇命令BIM的目录下，我这里忘了写BIM好吧，我重新再来一下vim etc program，然后插入模式，这里加个b保存一下，保存以后还得让他立刻生效，然后就SARS profile。好，这回我再来没本word你看这一回他就输出了，这回他就输出了，没文的版本3.6.1没有问题，好了没？文装好以后你还要注意，我们需要改一下密文的配置文件，然后把它的镜像设置为阿里云。

好，我现在当前在哪个目录下，没文的目录下我看一下它的配置文件在conf路径下 CD过去，配置文件是 sites编辑一下。

好，那么镜像要配到美容的内部这个代码，我们可以从本机copy好，我就打开了我本机的没有 config settings。好了，然后找到镜像文件的配置的位置，把这个代码贴一下，但是这儿我得插入模式，然后暂停到这儿。好这就行了，然后的话保存一下这就可以了。

这样的话我们一会通过maven的去编译，打包的时候，它会下载第一次比较慢会下载插件，这个时候它访问阿里云就会快很多了，好，没文章好以后，下面我想装 My circle，目前你看我们装好了什么呢？Gre每本对吧？

然后我再装 my circle，这些东西，那么my circle我们可以通过让仓库来装，但是你看我CD到跟录音像一样，历史，my circle先搜一下，它资源比较少，而且你搜到的马赛克的版本是比较低的，我们现在都更新到8了。

因此我才一开始在路的目录下提前的下，好了， my circle的最新的库文件我需要把它装一下，我才能够在亚母仓库里收到最新的 my circle的版本，好装 my circle，我先把文件装一下，怎么装，也是用样本来装样本，然后的话意思到杠y my circle什么回车，好很快装好了，装了以后我切到根路径下，然后的话我搜一下就买circle一样，类似的。

My circle行。

好，这回东西就很多了，但是我不是说我都要我要装一个master或者服务器，它 copy一下，它的版本是8，后面买CK80是吧？好，然后就装一下一样，你知道y把这个路径把这个内容贴过来回车，那么他就会从仓库里去下载my circle的安装文件，然后自动帮我装好。那么my server的文件是比较大的，需要一个挺长的时间，我们就等装完以后我们再继续。

好了，这个过程比较慢，不过终于安装好了，安装好以后我把 my circle的服务启动一下，那么我们用亚麻安装的工具，如果是可以启动的话，我们直接用 system CTL这个命令就可以启动的话，用 start，然后后面跟的是你的服务的名字， circle d马斯克d是马斯克后台的服务的名字，回车，他需要稍微等一会儿停顿一下，因为这个启动也是需要一点时间的，好，这就启动完了，这个时候我可以CCM ctr，然后的话Seder's买Soady，看一下当前服务的状态，my circle d服务的状态它是Xu running正在启动，没有问题。

好，然后这个时候我们需要做什么？就是我们在安装的时候，我们之前在windows上也安装过，在安装的过程中，它会给我们生成一个临时的密码，那么这个密码在哪？他在my circle的日志文件里，所以这个时候我们需要找日志文件把密码找出来，好能够登录它把密码给改掉，我用命令 great，然后的话搜这个单词pass word，从哪个文件里搜 What？

Log，然后 my circle d点log，从 log文件里去搜password这个单词，我这里一下搜出来4个，其实我要的是最后1个，因为我在这个服务器上其实装了好几遍，装了33个装好几遍，最后一个是刚刚生成的，它的密码很复杂，就这个了，这根本记不住 copy。

好，copy完以后我们就用密码登录一下my circle，然后把它密码设置为我们自己能够记住的 my circle杠u root杠p密码粘贴过来，登进来了。

好，那么登进来以后我们修改一下 my circle的 root，用户的密码，auto user root at look host。

I don't find后面写上这个密码，你注意 my circle， Linux版本它要求密码要求的比较高，它必须有大写字母，必须有特殊符号，必须还得有数字，所以说你不能说简单的123456不行了，我这样我写now cold下划线123用这个密码，好回车，回车以后可以了，我就先退出一下，然后用我新的密码重新登录一遍 my circle杠u root杠p now hold下划线123。

可以的。好了， My circle我就装好了。

装好max以后，一会我们用的时候它需要有初始化的数据，咱们的测试数据，这样我们跑这个项目的时候才能跑得起来，所以说我需要导入数据，我先CD的word目录下，你看这里边我之前不是传了我们用到的4月份的文件对吧？

好，我现在先把它解压缩一下，解压缩这个文件就需要用到IE命令按然后杠d解压到哪个目录下， root目录下，然后文件名你 c口点g回车好，解完以后再看一下，有了一个目录我进去不用进去，就是这里边三个文件我直接写了，我需要登录my circle，然后执行这三个文件导入数据密码登录进来以后我先建个库，叫community和我们之前的保持一致，瑞德贝斯 community，ok然后又是community，现在我要导入数据了，用命令SARS root in it。

Gun circle。然后第一个文件名叫in it god。Game点server，好，导入完毕，然后再来。

第二个是in it data点circle。完了就第一个是我们创建所有的表，什么帖子，优质这些表。第二个 data是测试数据，然后还有一个 cart，定时任务的工具所需的表也需要导入进来。它的名字叫tables。My circle。In the DB点circle。打完以后咱们看一下，so tables这些表都是我们熟悉的对吧？然后这里需要注意优点，我们需要稍微调整一下，为啥要调整？主要是调整数据，不是调整结构，为什么要调整给你看一下，谁来ID有人类，either you are ill，you are user。

这里边有一些用户的头像的路径是logo house的是本机，对吧？我们本机有这个服务器上你logo house的访问的服务器，本机在这上运行的话，那服务器上没有这个东西对吧？所以说路径你要是用这个路径的话就找不到这个图片了。

所以我们需要把这样的带有logo house的单词的路径改成这样的方式，好能找到这个图片，能找一个图片，至于找到是哪个图片都无所谓，要不然看不到，很难受，我随便copy一个，然后的话更新一下 User。Update user。Site，hider。12等于粘贴过来都等于一个固定的，我换一个不316了好吧，666t点PNG好，都改成同一个头像，然后给个where条件 where either you are like local house。就是说你路径里带local house的这个单词的，我就把它换成这个路径可以了，然后你再查一遍，最后就没有找本地的图片，这样就好了。

好，那么my circle搞定，我退出去，接下来不要装radius，这个radius我们可以利用这个样来安装，然后版本不是最新的，但是也够用了，我试过。好，我就搜一下一样的类似的release。行，就一个就是它 Copy以后我装了一样的。 In，store杠y他这个包比较小，很快就装好了，装好以后我要启动ready这个服务还是 system CTL start ready？启动以后看一下状态对不对？绿的对的。

好 Release就可用了，我们可以测一下， read it cri反映他就是解密客户端，然后你kiss行，啥也得不到，但是命令能执行说明ok的可以了，推出好，那么rise我们也就装好了，再来再装卡夫卡，那么卡夫卡我们不能用亚麻安装，我们需要用压缩包，那么有再去入的。

看一下它，好我还是把它解压缩到opt的目录下，它杠zvxf然后的话卡夫卡点它 tgz然后的话杠c OBD解压缩完以后我们去 OBD下看一下，看看有了那就进去再看。它有一个肯目录里面装的是配置文件，我们要看一下配置文件有没有必要改。

Cd肯定搞错了，CD肯定是好，他这有很多配置文件，其中我们之前也讲过，我们要看的是主keep还有 Siri，我们先看主keep，你看他这已经配好了，就data dir主keep所产生的数据会存到路径下，temp tmp主基本这可以这个路径我们不用改它，临时文件都放到tmp目录下，在Linux系统下没有问题就这样，然后退出了，然后再看 server，点process的break，ID就是服务器的ID节点的ID是0没问题，然后再往后看它也有一个路径， log drs等于 camp卡夫卡洛克斯这也可以，我们不用改这路径，就是符合Linux的规范，好退出默认配置就可以了，我就不改配置了。

那么接下来我就要启动这个组keep，然后再启动卡夫卡，那么我们需要敲命令去启动，就现在我在哪个目录下往上退一格，退一级。

好，我在这个路径下要启动，组keep，但你注意我们之前启动组keep怎么启动的，敲命令，然后的话在命令行敲命令启动的这不假，但是我们是用前台的方式启动的。那么如果说我把 come on的命令窗口关了，那么这组paper就死掉了。这是前台的启动的方式的一个弊端，你窗口一关掉他就挂了。这是服务器，我不希望窗口一关掉它就挂了，它应该一直在那跑着，除非服务器死机的对吧？怎么办？

我们需要用后台的方式来启动，我们之前没有尝试过如何采用后台的方式启动主keep也很简单， b然后 Super server start，sh我要执行这个命令，然后后面加一个参数，drmdaemon我用后台的方式来启动，然后后面再跟上，我要使用的组keep的配置文件回车启动了，好，然后用类似的方式来启动卡夫卡，但启动卡夫卡命令和它还不一样，那卡夫卡后台启动是这样写， no hard。然后 B卡夫卡server start执行卡夫卡的命令，然后用哪个配置文件是config？Server点process，后边还得跟着这样的一句话，一大于号dev杠 now然后还得写二大于号 and一，然后再来一个and固定的写法，你必须这么写，它才能够后台启动比较别扭，它每个方式还不一样。

好，然后回车启动这是它的 ID进程ID，好，那么启动完以后我们测一下怎么测，当然你可以给卡夫卡的创建个主题发个消息什么的，你可以测我就不那么麻烦了。我尝试执行什么，就是我尝试查看一下卡夫卡它里边有哪些主题。看一下。

B卡夫卡topics，sh还有杠杠list，杠杠，bootstrap杠，so然后我要访问的服务器 local，host是本机的929092，那么卡不卡它默认的 IP默认端口是9092，然后回车，稍等一下，最终他什么也没打出来，为什么？因为我这个卡不卡刚装好，他什么主题都没有对不对？

所以打印出一个空行来，但是他没报错，那就意味着这命令是可以执行的，而且他卡了一下，他确实在搜没搜到而已。对了。

好，这是卡夫卡。安装好了，下面我再来安装 Elastic search，这个工具也是通过解压缩的方式来安装 CD到root下，我已经提前下载好了安装包，you let it take search把它解压缩，然后还有一个分词插件，把这个分词插件解压缩到 plus目录下，我们要解压缩两次。

好，我先解答说你来stick search杠zv xf然后以less take search，然后是6.4.3，踏点gz杠杠c然后的话opt好了，回车就解压缩过去了。

你别忘了我们还有这个插件，也需要解压缩到 us text search目录下，它是zip的包，这个插件没有踏包，只有zip的包，我就按z杠d安，最普的命令是后面跟的是你要解压做的目录杠d目录 opt less take search6.4.3，然后普拉蒂斯，然后注意普拉蒂下面我要建个ak目录，把这个插件放到 ak目录下，当然我普拉丁Cr默认没有，ik你这样写的话它会自动帮你创建好这个目录。

好，然后你解压缩哪个文件是以last search杠analyse，好了，然后回车，完了以后去看一下 cdopt you last take search，这里有这些东西，我们进到普拉丁之下看一下，用ik进到ik下看一下，有内容没问题，好，然后以last设置，我们需要对它进行一些配置，我再重新拿CD到obt以来CT目录下看这个目录下有它的配置文件， CD到看这个目录下看一眼好。

首先我们要配一来stake设施点yma这个文件打开它打开以后插入的模式我们需要配什么这个地方，我们需要配集群的名字，我把它改成老抠的，我们之前开发的时候也是这么干的，和我们的开发的代码的保持一致，后边的话有 pass点data是它所产生的数据要存放的位置，我希望它和卡夫卡什么的保持一致，我们把这个数据都存放到tap目录下。可以改一下你看。

然后里边建一个e list这个目录，然后再建个data子目录，把这个数据放到这里来。当然这个目录还没有，它会自动创建，好在后面还有一个这 pass点loss，就是 Elstx设施所产生的日志文件存放到哪里这里我也改一下，放到天p less take locks目录下好了，这样就可以了，其他的地方我们就一律默认就完了。

另外我再改一下 jvm office，就是说我一来是take设置它占用的 Java的内存空间占多少，我们需要给它改一下，它默认占一个g太大了。我们一共4G内存，它自己占一g的话，其他的就不够用了，我试过它占一g我们这些东西又跑不起来了。

好，我打开 Gvm options，你看它这默认了，占了一g最小启动时最小占一g最大也占一g就改一下改成256，启动时它占256g内存，然后的话最大512，这是256512兆。

好可以了，其他的不用动，保存一下。

好到这一来是设施我就装好了，装好以后你要注意，你来CK设置它的要求比较，它不允许你用root用户去启动，你必须用普通用户启动，怎么办？

我还得建一个普通用户，我就group艾特先增加一个用户组叫脑壳的，然后 user at脑壳的一密码123456，然后组脑壳的就是我建了一个脑壳的组里边建了一个用户叫脑壳的一密码是123456，好了，完了以后还得给用户设置权限，他得能访问opt目录，能访问到 e list的设计，还得能访问到tap目录，能访问到他的日志文件数据目录，我CD到opt目录下，然后 chown用命令杠r然后扣点e冒号，我扣的后面写个星，比如说用户他在对目录拥有所有的权限，他可以访问目录下所有的资源。

行，我就省点事就这么配了。

好，然后同样还得配 tap目录， cdtmt然后也是刚才的命令，脑壳的一脑壳的，然后行，好了，那么配好了权限以后，我们就切换到脑壳的一用户上面去， su杠，然后后头一你看我这脑壳的一什么已经切换，切换完以后我就CD到高PT，以less take search目录下，还是用后台的方式启动它，后台启动以less take设置怎么办？这样并 you let it take search，然后后面跟个杠d就可以了。

好了，执行完以后我们需要也是做个测试，这样我测试之前我先切回到 Root，用户那就ICU杠后面不用写root，杠默认就是root，你需要输入密码，拷贝一下。好，我切回来root用户这回我要测一下，我就发出个请求访问一下。

 Elastic shirt服务器 curl杠x get然后的话，local house冒号9200斜线，health v就是通过命令访问一下，一来txt它的服务器是否健康，回车，你看green健康着已经启动了，可以了好了。这样的话我 es也就也装好了。

好，这一排工具，还有一个就是wkhtml图PDF我再把它装一下，我再回到命令行，这个可以用样本安装，我就先切换到根目录，然后搜一下一样的 list，wkhwk html to，PDF后面跟个星回车，很快就搜到了它wk，html to，PDF x86-64，好，我就安装一下 erm in store杠y粘贴。

好可以了。

可以以后你要注意这工具默认在我们windows上，这样就可以了，但在Linux上还不能用，因为我这个Linux是一个纯服务器，它没有 gui程序，它没有能处理界面的程序，所以你 wk这个命令是用来生成，PDF用来生成图片的它是和gui有关系的，它需要gui的支持对吧？你又没有怎么办？我们需要装一个模虚拟的。Gui程序 Gui服务器。好，所以我还得搜一下一样的。

然后历史星 xvfb行搜一下，你看这工具它是叫xorg杠什么server？Xvfb它是在中间的，所以说我需要前后加个信用卡就装它了，复制，然后再装一下，这样 instead粘贴安装，很快就装好了，装好以后咱们测一下，看一看我们利用这两者能不能生成图片，我在哪生成 Root？Test我要在 test目录下生成图片，怎么写命令的这样写？

Xvfb-y你得先指定虚拟的 server，声明什么？后面加参数 Server，UPS，杠杠serve杠UPS，然后等于双引号杠screen。空格0，然后再来1024叉768。叉24。这块其实主要是设置我生成图片的时候，那么我采用的分辨率是多少分辨率，指定是分辨率，屏幕的分辨率这个意思。

好，然后后面跟的是我要运用的命令，我用的命令是wk，然后 Html to，因为我们项目中直接生成图片了，然后指定你要给哪个网址生成图片，HTTP s wwwbaidu.com，生成图片叫什么名？一点PNG完了回车，好完成以后看一下，有了，但是这个名称这样写太麻烦了，我们每次都这么写，太麻烦了。

我们可以再把它包装一下，我把它copy一下。怎么包装？就是说我们自己写一个脚本，然后的话它把这句话封装一下就可以了。

我两个CD到opt目录下，我在这里自己写一个脚本，我这样写 Wimwkhtml to，image点sh，这是一个脚本的名字，打开以后这是我们新建一个文档，里边什么内容都没有，你把刚才的等插入模式，刚才代码粘贴进来，xvfb杠run什么wkhtml to MH然后再来后面你要写一个引号，然后到了这是就是说我们通过命令可以后面传一个参进来，这是表示参数的意思。

好，然后保存完以后ll你能看到这个文件已经生成了，但是他有读和写的权限却没有执行权限，我们需要给他执行权限。 Ch mode加加x然后的话wk什么？回车再看，那么它有了执行权限，既然有了执行权限，我们就再测一下我在CD的root test目录下，这回我要调用的是opt下面的wk工具是我包装好的工具，然后给它传参HTTP，s三w百度com二点PNG回车好也生成了，看一下二点片机有了，这个工具也可用了。接下来我要安装的这些零碎都安装好了，接下来我就安装Tom cat，然后最后再安装NDS这就快了。

好那么Tom cat也是采用解压缩的方式安装 Cd到 Root目录下，我已经提前从官网下载好了这个文件，我把它解压缩一下，它 cvxf然后的话阿帕奇他们看，然后把它挤压缩到也是opt的目录下，那么解压做好以后，我们需要给他们开的配这个环境变量，因为我们可能可以随时随地去启动它，去关闭它，而不是非得切换到那个目录下。

好，所以说我就先CD到 opt目录下，然后阿帕奇 Tom cat我先CD到这个目录下，然后在CD到b目录下，因为它的命令是在b目录下，对吧？我pwpwd一下把它的目录拷一下，拷完以后也是配环境变量vim然后的话etc profile改这个文件也是在pass后面加一个路径而已，我和类似 Export pass等于到了pass冒号，然后把路径贴过来。

就是Tom cat并目录贴过来，别忘了保存，保存完以后要想生效，还得执行 SARS命令 etc program，然后我们可以打印一下一口糟了，pass你看有没有放开的油，但是打印的时候会发现 maybe有重复，这个其实不影响使用，然后的话如果你把这个窗口关掉，重新再次连接的时候它就ok了。因为我们这次实力没有重连，所以说它就会有这样的一个情况，重连以后就好了，这不是问题。

好了，既然他们开的已经安装好了，我先不去安ndx我先把它启动一下，直接访问他是如果没问题再装index，用nx的分发请求给他，我在访问index是 Tom cat的启动命令，我可以这样写start up点sh回车 start其实这需要一个过程，需要一个过程，稍等一会儿。

我这样我可以CD到opt阿帕奇Tom cat目录下看一下，那么它有一个con conf目录这里可以对它做一些配置，它有一个lab包里边是它自带的依赖的一些炸包，还有lock里边是它启动的一些日志，所以如果说你的tomcat启动完以后访问不了，你可以看看它的日志是不是启动的时候有什么问题。

还有一个很关键的目录是web，APP我们部署的项目就放到这里来，我们新装的他们还在这里是有一些默认的东西的，我们看一下这里面每一个文件夹就是一个项目入的项目，manager项目，excellence项目，DOC思想等等，它默认带了几个事例，带了几个事例，我们可以访问。

好应该是启动起来了，我打开浏览器，但我得通过IP访问它 copy一下hgdp冒号双曲线，那么Tom cat默认端口是8080，我就访问80 80回车，这是tomcat的默认的一个界面，这界面是从哪来呢？咱们刚才不是看了吗？它里边不是有几个默认的项目吗？那么我们访问他们开始他默认会访问 root下面的首页，其实我们看到这个界面是root的首页，就是这样的。

好，看到这个界面说明什么？我们刚开始装好了没有问题，好，我们再回去接着装最后的一个软件 nexus。我还是回到根目录，然后我搜一下 Ndx也是可以压门安装，类似的恩格斯行就是它了，ndxx8664把它拷一下。好，然后就安装一样，y粘贴很快就装好了，装好以后 nx怎么样才能分发请求？把请求分发给汤太的，这需要配。

好，我们来配一下 vimetc配置文件的在etcndx目录下，配置文件具体叫ndx点conf插入模式， n这一项，它的配置文件的结构比较复杂，那么大家如果说你没有了解过，你可以课后找点资料自己看一看，前面比如说 events什么include，这些都是一个公共的一些参数，这里我们不管不用动，然后他它配置文件的结构是分块的，是分层次的，最外层的是HTTP，然后下面有一些公共的信息我们也不动，然后后面是server，其实我们主要是配 server，配这个server是配什么？

配一下，我们是配一下什么呢？我一共有几个Tom cat，真实的服务器有谁？那我ndx再配一个虚拟的服务器，把请求分发给真实的服务器，所以其实我们配什么？就是配虚拟服务器和真实服务器之间的关系。好，这是它默认给的一个示例，我们不用这个示例，我把它注掉，别删注掉你可以做一个参考。

稍微小心把它注掉，当然我们一会配的时候会比这个简单，然后它有杰克斯有很多功能，那么我们只是利用它的一点点功能做一个请求的分发以及负载均衡，当然其实我们只有一台服务器其实也均衡不了，其实主要就是请求分发或者叫反向代理，用恩杰斯来代理他们开的代理服务器的服务，我们叫反向代理，那么代理浏览器的叫正向代理或者就叫代理，好回来，我把这个重要以后我要配自己的内容，首先我配什么呢？

 Up steam my server，这个是配我真实的服务器，我真实有多少服务器，那么请求就会分发给真实的服务器，我这里只有一个，但其实可以配多个 server，然后的话1127.0.0.1，就是本地本机端口是8080，其实就是本机的。他们看对吧？

然后后面写上max filth=3，什么意思？如果说杰克斯向汤姆开始分发了三次请求，都没有得到正确响应，他认为他们的挂他就把它移除到服务器的集合里，好，然后再来fail。Time out。什么意思？如果说他把这个服务器移除了，那么过多长时间，他会再去看一下你活没活过来，我这里给的是30秒。如果说三次访问你没有响应把你移除，那么过30秒再访问你一次，看你能不能活过来这个意思。

好，这是上面是我配好的真实的服务器，后面得配一个虚拟服务器能够分发到真实的服务器，这一堆服务器里，当然这里只有一个怎么配12万。

好，lesson80，比如说我虚拟的服务器使用的是80端口，监听的是80端口，那么所以你只要敲120.55.53.21780端口是默认的，直接仿的是谁呢？

我虚拟服务器好，然后接着写 Name，server下划线name120.55.53.217，这里我写的是IP地址，那么因为我没有域名，我只能写IP，其实也可以写域名，就是说当你通过这个IP以和端口访问的时候，它就能够监听到它就能够接收到，就由他来处理他怎么处理 location，实现意思是你访问访问的是根路径，这个就是12120.55.53.217，80我认为是根路径，斜线表示根路径，这根路径我由谁来处理，由他来处理，这怎么写很简单， pricing pass，然后的话HTTP冒号双斜线，myself意思是如果有请求访问的是它的80端口，那么我就把这个请求分给这里边的某一个服务器，当然平均分分给这里边的某一个服务器去处理，现在只有它了，就送给汤太太处理了，这就是分发了，这种行为就叫反向代理，你访问他把请求给他，就这样。

好，然后保存一下。好，保存完以后我测一下，我要启动一下，因为我是用要么安装的，所以说它的启动服务已经自动装好了，我可以用system CT start来启动它。好，那么它出现这么一句话，说failed表示失败了，失败的原因基本上我刚才配置的有什么错误，所以我需要检查一下，看看刚才哪配错了。

好，我们看一下就所有改的代码，首先是这里有一些注掉的代码有没有搞错，再看一下我刚才写的代码，那么上面这都注掉了，这没什么好说的，主要是看这两个代码需要注意的是什么，就是这里边括号里边配的每一句话，后面都得有分号结束，而且是英文的，然后那就没有都是分号都有，我就看一下写的代码有没有错误。

 Time out这个单词写错了，好，再检查一下upstream，好就这样我们试一下 wq然后我再次尝试启动恩格斯这回它没有什么提示表示应该是启动成功了，你可以再看一下 system ctr status，index状态是running没有问题，好，这个时候我尝试去访问一下它，回来我把这个端口去掉，直接访这个IP，直接把这个IP和你写上80是一样的，因为默认就是80。这个由谁来监听？就由 Ndx因为我们配的回车，一回车看到的还是Tom cat的这个界面，为什么？因为他把请求分发给了他们的助理，但这个地址没变，依然是这个IP。

就是说你感知不到它的背后是有另外一个服务器，你就以为是 Ip处理的，但其实是另外一个IP另外一个端口处理的，是吧？是这样，好了，现在我就把我要装的这些东西都装好了以后，那么接下来要做什么呢？就是要把我的代码部署下去，部署上去了，主要是把我的代码部署到 tomcat的web APP的目录下，那么在部署之前我还要说一下就 ndx他们开的他的一个怎么说更更细致一点的关系。

再一个我还要说一下 Tom cat和部署项目之间的关系，你知道我访问了恩杰斯，恩杰克斯和tomcat什么关系？Tomcat怎么去访问他下面的项目，这个关系搞明白以后，我们一会再配的时候，有的地方你才能明白，这个我重新画个图，画个简单的图。

好，首先我先画一个方块，假设这就是我的方块。好，然后他们看一下，刚才我们也看了它里边默认带了几个项目对吧？我把它写一下。第有一个项目叫root，然后好像还有个项目叫examples，当然了我们后面要部署的项目也是放到这里来，也是部署到这里来。

然后我假设我 Tom cat它的访问路径，它的IP地址端口号是什么？假设是1.1.1.1，好8080这样我简单好记，好这是Tom cat，那么Tom cat之前有什么不是有 Njx对吧？我再画一个方块用来代表 Nx，谁来访问 ndx当然是浏览器客户端了对吧？我还得换一个浏览器，那么浏览器他发出请求访问的是ndx然后 Ndx他把请求分发给汤盖，我们在这里只有一个唯一的汤盖。

那么你注意恩杰斯它是有它自己的 IP的，我假设虽然我们是一个服务器，但是我做个假设，它的 IP是1.1.1.0，冒号端口是80，这是ndx浏览器要访问tomcat，他需要通过nx访问他的地址，它的域名写成什么呢？他的IP得写成或者是把80去掉，也可以因为默认80或者是我们买了域名和 IP绑定到一起了，做了域名解析，这个时候我敲域名也可以，比如说域名是not code.com，当然我没买，只能敲IP了，实际上买了以后就可以这样了，你敲这个域名，通过域名解析找到了对应的IP就访问ndx然后 ndx把请求分发给了真实的服务器淘汰，是这么一个过程，这么一个过程。

然后我们看到的我们刚才是这样做的，我们访的是 ndx然后他分发了给了 Tom cat，然后我们看到了一个界面界面，这个界面刚才我也说了，他们开的访问是谁，默认访问是入的项目下的首页，就是说你访问他们开的，他默认会访问入的项目，这就有一个小问题，如果我要访问张老师这个项目怎么办？

你得这样写这个路径你这样写脑壳的.com，直接写这个域名是访问root，如果你要访问一个张老师，你就加个下级一个张老师，就是说你这样写是访问root，你这样写是访问张投资就有一个问题，如果说我要部署我我们的项目，不是叫肯定那天好，如果我这样部署的话，你看防火的项目是不是得写一个脑壳的.com斜线，肯定那天你这样不别扭吗？

对吧？你看哪个网站，我们访问的时候还得敲个下级，我们只能记住淘宝.com，baidu.com对吧？脑壳的.com下级是很难记的，所以我们肯定是希望什么？我希望我想脑壳的.com你就访问肯定的对吧？

好要想达到这一步，我们需要做一些处理，怎么处理处理方式，不只是一种其实有很多种办法，我们习惯于这么干，首先我先把 Root删了，没有root，然后我把肯定的项目打包的时候就打包成root，但是打包它是个包包root点，那么他们在一启动一运行，这包就被自动解压缩成入的目录，明白吧？

这样的话我们写脑壳.com就访问了，我们肯定的项目，通过这个办法去解决这个问题，我们把这个项目打包成root点y好，当然了，我们这个项目原始的名字是叫community对吧？是把它打包成了 root点，这里有个打包的行为用的是package命令，然后这就完了吗？也不是，你看如果我这样的话，处理完以后我先拿code.com，他就访问了 ndxndx分发给了1.1.1.8080，那么它默认就访问了community，你注意我们直接访问肯定那天会得到什么呢？

我们访问肯定那天的跟路径会得到什么什么也没有，因为我们在control里从来就没有处理过这个路径，对不对？

所以我们还得想办法再处理，还有一个根路径，不然的话什么也得不到，我就得处理根路径，根路径是什么？斜线这个路径其实我们是希望直接访这个项目，它会返回首页对吧？我得想办法让它等价于 index，在做这件事，把它搞明白就可以了。

怎么样才能让根路径等于index有两个办法，一个是我访问斜线，就重叠项的windows这就等价或者是转发过去也可以，那一会我用转发，这样路径这样就不用发一个新的请求，这个请求就可以解决问题。

好，然后还要注意，你看我们访问 Root的时候是不用写个斜线root的，也就是说 root这个项目它没有访问名，root项目没有访问名，既然can没有那天我们把它做成入的项目，他就应该没有访问名，所以我们之前项目中加了访问名，在这个时候需要把它去掉变成空的值。所以我们一会儿要对项目基于这个规则要做一个修改，就是把这个肯定的项目能改成空的值。

另外还要加一个对根路径的一个处理，让它访问index。好了，说完这个逻辑以后，接下来我们就来处理刚才我所说的这几个点。首先我要把 Root先把他们的自带的这个东西删了，好我回到服务器，我CD特别犀利，我先把他们给关了，你要删东西把它关了，SARS down点sh把它停止。

然后 CD到opt阿帕奇Tom cat目录下看一下，这里边有web APP进去看一下这里边有好几个项目都不是我们要运行的，是我们自己的项目，而不是他带的事例，干脆都删了算了对吧？你就 remove杠rf行。好，再看什么都没有了，删掉了全删了。

全删了以后，接下来我要调整代码了，我打开我的idea对代码进行调整，首先把项目的访问名改成空值改配置文件了，application practice在最顶部，这不写了肯定的地方把它改成空值，注意就等号后面什么都不写，就是空值就是空不是闹就是啥都没，有空值空字不串。

好别忘了，还有一个地方需要改，我们前台的logo点GS里也定义了项目房名那地方也得改搜一下个logo点GS，这地方也得改，但是你这个地方满足他的语法改成控制不串就可以了。

所以这就是我们当初统一定义的项目名要改的时候的便捷之处，不然的话你把这个项目名拼到各个角落改就麻烦了，这还好就改两个地方好了。改完以后还不行，我们要想部署的话，还需要对这个项目做更多的一个改造。还有什么？这个跟路径的处理，我回到我的idea，我打开 Home很重要，我们在这里定义的首页不是这里有首页，我再加一个路径的处理根路径根，路径就是斜线，我叫root跟路径跟 root，然后 return转发或重新下我转发了 index，所以你访问它就相当于访问index等价，好这个改完以后还不行。

我们打包的话，你看我们之前的配置文件，home之前就是我们没有进行声明，他默认打包会把这个项目打成炸包，但我们现在是外部项目需要打成外包对吧？你需要对它做一个处理，你要在这写一句话，叫package，然后我还希望你打的袜包名字叫 root对不对？怎么去声明外包的名字，需要在最底下 Build编译的地方去构建的地方去处理，在这里面需要写上 final name，最终打包的名字叫什么？叫root，这样就行了。

这样的话我去。

怎么说。

我去打包这个项目就能够得到一个名为root的花苞，这就行了，还不行还差什么？

我先把这些先关掉，还差什么配置文件，你看我们项目中有两个配置文件，一个是application practice，一个是 look back，那么这两个文件你看这里边的路径d盘，我们的阿里云的服务器它是Linux，它可没有d盘，你这得改，对吧？这里头也有类似的现象对吧？包括一些IP地址，包括一些路径你得改，但你不能直接改原文件，你改它的话我们部署没问题了，我们本地执行就有问题了。对吧？难道说我把它改过去，然后我在开发的时候再改回来吗？那也太麻烦了。

所以 Spring boot它有一个好的解决方案，它允许我们项目中存在多套配置文件，我开发时一套，部署时就上线时生产环境一套，测试是1套，你可以3套4套几套都行，然后通过一个开关去启用，哪一套配置文件，这里有个简单点就两套，开发一套，然后生产环境也就是部署的时候一套，好这样我先关掉，这样我把这个文件 copy一下CTRL c CTRL v然后改个名字需要有一定的规则，必须后面写个横线，然后写个单词，我叫得拜了，很显然配种件是开发使用的 develop，然后再把它拷贝一下 CTRL c CTRL v然后这个是love back spring横线对外的，好，就是说这两个文件是给开发时用的，这两个文件需不需要改，因为我们之前开发时做的配置就是给开发使用的对吧？

不用改，但是有了就可以了。

好再来我再点它 CTRL c CTRL v再给第二套，就是生产环境用的 produce把它复制一下，可能c可能v也是杠produce，好我先这两个肯定要改的，我先不说这两个怎么改先不改，这是两套配置文件，一套是关键词是develop，一套关键词是produce，都满足固定的规律是以杠这个关键词结尾的，我怎么让simple的去加载某一套配置文件，我们需要这样它默认的配置文件里做一个开关，默认配置文件其实可以内容都删了，因为我们有了两套，另外对吧，这里需要做一个开关，怎么做也是很简单的，那么就一句话，这句话主要是对他支持叫profile，它这种模式叫profile，我们配的是和profile有关的配置，这样排 spring点儿，profiles点儿active。

我们目前激活的配置文件是哪一套？如果我写对外的，那么就是以对外和结尾的配置文件被加载，如果我写 produce，那么以produce结尾的配置文件被加载，因为我一会要部署到Linux上去，所以说我写produce文件就被加载，另外这个老板该怎么办呢？还得配上log back。得这样配了，log点儿挺费等于class pass。

Spring杠杠它点儿xml。什么意思？就是说我 Log back的配置文件加载的是克拉斯帕斯之下名为log back杠spring杠，这个开关所对应的名字的xml文件，我现在是投丢，所以说它加载的是配置文件。那么总之我们在以后我们开发的时候就把它改成develop，我们要部署的时候它就把它改成produce，这样就可以了，就非常方便好了。

那么除此以外，最后还要处理一个地方是什么呢？你看我们的启动文件，我们之前是直接run Main方法对吧？把它当做一个普通的Java程序来启动的，但现在我们是要把它部署到 Tom cat里，把它作为外部项目来启动。他们开的就是由Java来做的一个软件，它本身就有main方法，不可能就是一个Java程序，不可能有两个命令方法对吧？

不可能命中掉命，所以说我们现在就不能执行命了，脱不开的调哪个类从哪个入口去执行这个程序，我们需要给他一个入口，我们需要给他提供一个接口，所以我们就在当前的路径下新建一个类，实现一个接口在目录下，这个类的名字我叫community so late，然后的话一定是来着，当时写没写错，就是说这个单词写错也无所谓，但是最好是别写错没错，然后需要给它实现一个接口。不是是继承一个父类，通过继承父类的方式间接的实现一个接口。我们继承的是spring boot，然后的话写错了，spring boot。

然后 So late it is lies继承于它，然后我们重写它里面的一个方法，这个方法叫做config。这个方法有个参数叫builder，这个方法内部的逻辑我们要重写，很简单就一句话，我就直接 return builder，resource source。谁 community？Application点class。

就是说 Tom cat会访问类的方法，通过这个方法作为入口来启动来运行我们这个项目运行的时候，我们这是声明，我们的主配的文件，我们的其核心的配置文件是谁是肯定的，txt这里指的是配置文件，所以还是从它来开始加点配置好了，现在我就把我们这个项目需要调整的地方调整好以后怎么办？

我们就需要把这个项目部署到他们的下，把它拷贝到他们的下，我们怎么做？我先把这个项目的源码拷贝到这个服务器里，然后通过maven对它进行打包以后，把它搬到 Web APP下，复制到那里去就可以了。

好，看一下我们当前的这个项目有target，我要把这个target移除掉，为什么要移除？这样我打包的时候小一点，传的快一点对不对？好我就没问颗粒，你看这个target就没了，好，没了以后我找到我的work space，把这个项目打包一下，我然后再上传好，压缩好了以后我就要传了，那就再打开本地的命令行。

我现在是处于d盘work之下，我要去的是 work space这里边我要传的是肯定没有内贴点GIP还是用明了pscp没有贴点GIP root艾特，然后的话是120.55点53.217，冒号斜线就我把它传到目录下，回车需要密码，拷贝密码粘贴过来比较小，很快就传过去了，如果你导出的话带着炸包就大了，这就很小。

那我再回到服务器，CD到root之下看一看它了对吧？我需要把源码解压缩一下，我好去编译它，我去打包它，我这是一个zip安，然后杠d放到就放到入得下，肯定得点击IP再看，有的肯定的进去，写错了进去，然后这里边没有他盖没有编译好的代码，我需要编译好，不只是编译还要打包，但你注意我不要测试，一测试我们的测试类都走一遍，而我们的测试类写的又不不标准，我们之前后面我单独讲的测试写的什么标准，所以说你执行的话会很麻烦，不要执行测试怎么办？

我们这样写命令 Maybe可令，如果你已经编译过你就肯定一下，如果你没编译肯定可以省略，这里我就写一下拍k上打包，然后的话杠d加个参数没稳点儿，taste点儿，skip忽略，等于数我要忽略测试不要测试，然后回车。

那么如果你是第一次安装没问去执行的话，它可能会下载一堆东西比较慢。我的其实已经执行过它本地有缓存的那些个包，应该不会太慢，好，咱们稍等一下，成功了看一下。 Cd到to get目录下，有了root点y对吧？然后我就把root点y拷贝到它们的下，就算部署了，我就 move移动到 tomcat支架，他在哪？

在 opt阿帕奇tomcat放到 web APP的下面，我这个写错了少了一个文件名，这样不对，你得在后面跟着文件名然后再写文件夹，文件名是root点，然后的话是 Tom cat web APP的目录回声，好移过去了，你看当前的目录没有了，然后我CD过去，好看一下，有了root点就只有这一个，这个时候我就start up sh启动他们看一下，但是他马上提示说started其实还没有，因为我们的项目加载需要一点时间，没那么快，你可以这样，你可以去看一下loss，它里边有一个凯特琳的点，什么log，你可以看日志点，我好像有点问题，你看他报错了，为啥报错了，我突然想起来了，退回去，我突然想起来了。

刚才我是把这些处理好以后，我刚才是做到这一步，复制了两个 produce，这个文件以后我没有改对吧？这个里面没有改，所以说这里面参数不对，所以说这里执行不起来，这样我再把它再得当一下，忘了这一点了。

好我回去再改，好我再重来，先改 application，produce点practice，从上往下走一遍。8080这个没问题，然后这地方注意改成处就是我们部署环境一生产环境缓存可以启用，然后这里是look，house没问题，为什么？

因为我们Tom cat和 My circle他们是同一台机器，他们开的就是访问本机的my circle，所以说这里边写logo house没有问题， root然后密码给改了，其他的不动，这个地方不动，这儿没有，这儿不动，这儿得改。

读命，你得把这个IP改成我们现在的这个服务器的IP，它的IP就是HTTP冒号上线127点55。不是120记错了，copy一下120.55点53.217，后面的端口不用写，默认就是80，然后你上传如果上传文件的话传到哪去？我们不能写d盘了，那就是TNT，然后的话 Abalos，aaah传到这里来，好再往下看， Readies也是本地的，没问题，卡不卡？

也是本地的，端口没问题，然后 es也是本地的端口，没问题，这个task没有问题，看他没有路径，这不用改，wkwk这就有路径了，这个就必须得改了。

 Wk我们访问wlan对吧？然后是我们自己编的叫wk html to，image点sh对吧？然后 wk文件存放的位置，我们换一个 tmp wk杠。Image可以了。好，七流云的配置不变，后面不变改好了，然后 look back，别的地方不用动，该当然你也可以比如说把控制台打印去掉，比如说日志级别可以调，这里我不调了，我们必须要改的是什么？是路径，对吧？

你不能放到d盘，没有d盘，我放到TNT下，可没问题下面好，这就可以了，这回才算是改好了，刚才有点问题，我得重新上传删了，重新打包一下，压缩好，然后我再重传一遍，还是执行刚才的命令 Pscp什么？

回车，密码好充完了充完以后回到服务器，然后 CD我是不是杀的到杀的到 CD到root下看一眼，这肯定都是新的，我把原来旧的给它删了。

好，然后重新解压缩一下。那就是on，zip杠d root。放到root下肯定没有内存点zip。

好，看一下。 Cd进去，好，我去看一下确认一下这个是有变化的。 Cd的c下面下为SARS之下，然后我就vim application杠produce practice。你看这个开始变成true了对吧？然后这个域名变了，说明我们重新传，没有问题，好了，我需要去打包了，好就是这个路径。

然后我就重新打包一下，没问不写颗粒码还可以查看d没问题， Test。Skip two，好，然后回车。好，看一下，打完了进到target里面去，我把 root重新移动过去， root点，然后放到opt阿帕奇Tom cat外部APP目录下，他说已经有了，你要不要覆盖？好，当前没了。到了唐凯的家，我重启唐凯的start sh好，我们可以CD到 OB t阿帕奇tomcat，外APP下看一眼，确实有这个文件，然后的话这个时间是更新了。好，然后你看它有一个root文件夹，就是我一启动它们看的它就会把包解压缩到这儿来。

好，然后我再看一下日志， Cd到logs之下，vim卡特琳娜2019什么回车，我们看后面你看他又报错了，他又报错了，他报错了说什么是有个d好像刚才我也看到一个d的文件夹，可能是刚才我配置没改，它生成了一个错误的东西，刚才造成的影响还挺大，我再去把它弄一下，再set down一下。

然后再当前是洛克斯的CD点CD y的APP，它有个地冒号这么一个项目，这个肯定是有问题的。 Rm杠rfd冒号杀了他， Rm杠f我干脆把 Ruetz文件夹给删了，只保留 vau，然后重来 start up，再去看他的日志，就是我们部署到服务器上以后，我们就没有办法用工具来调试了，我们一切都只能看日志，所以说一定要习惯于多看日志。

当前是外边APP CD点点，CD plus看日志，再往后翻。

好，最后它会有一个过程，然后会有一个提示，刚才那个错是刚才的，它会有一个提示，它提示说started server音多少毫秒对吧？

然后再看看再往前你看它就会提示，它就是解压缩了袜包 root点儿袜，这是汤派的它启动的一个日志，我们退出去，我们再看我们自己的日志，我们自己的日志我们配了是在探探目录下 cdtmp你看这里都是生成的一些放日志的文件夹，community就是我们自己声明的它自动创建的CD community。

好，然后你看这里边就有什么各种日志 one和era没有只有infer没有错是吧？好我们就访问一下，现在已经启动起来了，访问一下，我回到浏览器，直接访问ndx然后分发给我的Tom cat写这个路径就可以了。然后原来访问是猫的界面回车，好，现在就访问到了我们的项目，这是首页返回的内容对吧？然后你可以点注册点登录，你看他没有肯定的在一起直接 log in什么的，对吧？

比如说我登录aamvbs。

登录没问题是吧？然后看一个帖子没问题。

发个帖子也可以。

进去看点个赞也行是吧？

然后再回个帖也没问题，给回帖点个赞对吧？然后你这个点赞以后这里有消息了，有通知了对吧？谁评论了你谁点了赞，你也可以看就过来了，你看我点能点赞，说明release方面没问题对吧？然后我能发消息能发通知表示卡不卡？没问题，能不能搜索，刚才我是写的是测试部署是吧？测试搜到了对吧？

可以，但只收到一条数据，因为什么？我们 Estx设想我没有往里初始化那些，以前的旧的数据只有这一条，能收到说明es没问题，换个头像，换头像说明我们访问新能源，没问题，也说明wkhtml推灭命令没问题，基本上就是我刚才装的这些东西，数据库肯定没问题，ready是卡夫卡es这个工具我都能访问对吧？都没问题。

好了，这样的话我们终于就把这些内容都部署完了，非常的繁琐，但是你要知道你确实你在做这件事的时候，是需要经历繁琐的，而且中间会遇到各种各样的坑，如果你自己去做的时候，所以你们在自己尝试的时候，我建议你最好选的操作系统的版本和我一样，最好是3层os7，你跟我的命令都一样，这样的话就不容易出问题。

然后你要知道我们之所以每一个工具只部署一份，是因为我们的服务器是有限的，只有一台服务器没法部署那么多份对吧？实际的项目中可能是实际的环境中可能是他们开的各个工具都会部署，多数都会分布式部署对吧？我们是在这里就没法做到那一步了，因为太耗太耗这个福气了，没办法弄。好了，那么这次课我们这个项目部署就演示完了，这次课我们就进行到这里，咱们下次课再见。