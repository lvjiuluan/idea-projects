56-项目总结.mp4

到目前为止我已经把我们这个项目当中所有要演示的内容给你演示完了，那么这次课我们来做一个全面的总结。这里我画了一个图，第一个图反映出了我们这个项目中所开发的绝大部分的功能。

第二个也反映出了我们这个项目中的用到的绝大部分的技术，并且我让这两者之间产生了一个匹配和关联，然后让你能够直观的回顾一下我们这个项目中用哪些技术解决了哪些问题，就整理一下我们的思路。

好，我们先从技术来看，那么我们整个的技术是构建在 Spring boot之上，所以说我把它画到最底下，那么其他的技术都是依托在死人布的之上。那么当然了spring boot其实它不是我们整个技术的核心的东西，它只是起到一个辅助的作用，它能够降低我们其他的技术的使用的难度，仅此而已，它是起到一个帮助的作用。

而我们整个所有的技术的核心其实是 spring，我们所有的技术几乎都是围绕着spring来展开的，那么对于重点的技术你需要关注的内容，那么我画了一个下划线，其他的也是这个意思，然后在死不认不得之上，我们用到了它的很多模块，比如说spring mvc解决了前后端请求处理的问题，或者说它交互的问题，然后我们用到了死不用买betis，然后可以访问数据库。

再者我们还用到了 sprint，然后用它来管理我们项目中的安全层面的内容，管理我们项目中的权限。

当然了三这三个技术是构建在使用之上，由使用进行整合的，所以说我把它们画到了spring的上方。那么 spring mvc my bed is还有 secret，我把它们放到了一块去，意思是什么？它这些内容它是我们整个项目的基石，就是说我们这个项目当中几乎绝大部分的请求都是用这些技术来实现的，或者说他们都是基于这些技术的，所以它是我们整个项目的基石。

然后当然我们还用到了其他的技术，这些技术不同的技术解决不同模块不同层面的问题，那么我们看一下其他的技术以及这些基础，他们都分别解决了哪些问题。

首先我们做的是登录模块，以及后面的话我们又做了授权，其实我把它们合并在一起，称之为权限模块或者说权限管理模块，那么我们在开发权限模块的时候自然是用到了这些东西，其他模块也是除此以外，权限模块还用到了spring EMAIL，我们发了邮件对吧？

除此以外，我们还用到了spring mvc当中的拦截器 Intercept，那么这两项技术当中 intercept大家要重点的关注一下，因为它能够拦截所有请求对吧？能够解决一些通用的问题，但凡能够解决通用的问题的这样的技术，那么它涉及的面比较广，它影响了请求比较多，对吧？

所以我们一定要慎重，一定要关注，所以拦截器大家要多注意。然后权限管理的模块，我们主要是开发了这么多功能，注册登录退出，没什么可说的。

然后是状态，就是说我们在每个页面上怎么去显示这个登录用户的就是用户名头像，然后我们开发了用户的设置的功能，主要是可以上传头像，然后还能修改密码等等，最后还开发了授权你不同的类型的用户登录进来，我能让你访问不同的功能，当然这个是由 Skype来实现授权，然后这一些功能怎么说我们开发是开发完了，在这些功能当中我们还要关注一个比较重点的话题，就是绘画管理，这里我写了艾特绘画管理，你关注它，或者说你复习的时候多去看看这方面的内容，因为我们整个权限管理其实是构建在规划管理的基础之上的，没有规划的话，我们现在开发不出来这样的应用，如果没有会话管理前后端就是后端记不住前端的话，那么我们只能开发出一个类似于看新闻那样的网站，而要长期的交互，或者说连续的交互，要开发这样的逻辑，那就必须有规划管理。

那么关于规划管理你需要了解这个cooking session他们各自能发挥什么样的作用，它们的区别是什么？然后的话还有我们项目中我们后来规避了session不用session，这是为什么？是因为我们考虑分布式部署的时候，那么session可能会有一些问题，当时我也讲了，你需要去回顾一下，然后我们不用session以后我们是怎么去解决这个问题，对吧？我们是把数据存到了res里，另外我们还用到了时代的logo对吧？那么这些细节我总结课上不去讲这么细的东西，因为之前讲过，但是我提到了希望你课后自己去，如果你忘了自己去再看一下，再回顾一下。

好，总之权限管理从这个技术上我们关注一下 intercept，从逻辑上或者从业务上我们重点去关注绘画管理好。

那么然后我们又开发了项目的核心的功能比较多，包括首页、帖子评论，还有私信异常和日志其实都差不多，尤其是首页帖子评论私信其实都是基于crmvc实现的，而异常和日志这个怎么说是用到了一些通用的技术，这个需要重点的关注。

那么从这个业务角度来说，我们在开发这些功能的时候有两个重点，第一个你要关注敏感词怎么过滤的，主要是算法前缀数的结构以及相关的算法。再者你要重点关注事物，因为我们在这里解决了一些事物管理的问题，事物是怎么回事。再一个这个事物的隔离级别又怎么样，对吧？然后我们用 spring，我们是怎么去管理事务的，这些东西你要做一个回顾。

当然了这个模块我们是基于这些技术实现的，除此以外我们还用到了otherwise控制器的通知，我们用它来统一处理的异常对吧？

另外我们用到了LP学到了LP，用LP统一记录了业务层的日志，当然给人感觉是好像这个功能有点有点薄，然后的话好像我们其他的地方就没有用到LP，但是平时我们听到LP也听到别人老说，所以OB很重要，其实确实很重要，因为其实其他的很多功能它依赖于up，你像事物的底层就基于aop所以这op挺重要的，你要重点的去复习这方面的内容。

再一个就是事物方面的内容好，然后再往后我们开发了怎么说，我这里说的是一个性能相关的模块，对性能要求高的模块，这里包含了一些社交网站中常见的一些功能，包括点赞关注，需要高频的访问，需要高性能，我们是利用release开发这样的功能，但readies不只是能够开发这样的功能，它也能够做出一些更高级的事情，比如说我们统计了网站的 UV还有活跃用户对吧？

用reds的特殊的两个数据类型去做了统计，那么你也需要去回顾。最后网站中有一些地方我们觉得性能不够好怎么办？我们用rise做了缓存，然后提高了它的性能。那么就这个模块我们重点关注的是reds这项技术，详细来说我们关注的是rise的数据结构， Rise有那么多种数据结构，每一种数据结构适合解决什么样的问题，适合混成什么样的数据，这个你要搞得很清楚，你要自己去回顾一下。

好，然后我们又开发了通知模块，其实就一个功能系统通知，那么我们在这里用到了消息队列的一个框架，卡夫卡这个框架它在使用的时候非常的简单，特别简单，那么我们在复习的时候，你关注的不是这个框架的使用，因为谁都会用，只要你学了谁都会用对吧？

我们关注的是这个框架背后的一些通用的原则，就是它的模式，生产者与消费者模式。

我在写这个框架之前，咱们不是自己写了一个自己实现了一个生产者消费者模式，对吧？那么大家把代码也回顾一下，重点回顾与这个模式有关的内容。因为只要你理解了什么是生产者与消费者模式，你才有可能明白我什么时候哪些功能我可以用它来解决这个问题。银行来解决，你要解决的时候，你自然就会想到我就用卡夫卡就可以了。

好这样往后我们开发了这个项目中的搜索功能，当然我们搜索是针对这个帖子能做一个全文的搜索，它各个字段，我们用到的也是一个新的框架， Us take search。

那么这个框架在使用的时候也比较简单，我们在复习的时候关注的是什么？关注的其实也是它的数据结构，因为以来stake设施它也要把数据单独存一份，而它存的方式和数据库又不一样，它是以索引的方式来存的，你重点要关注索引的结构，我建议你去找一找相关的文章去看一看 Us take search索引相关的内容。

好，最后我们又开发了其他的一些功能，包括帖子排行，包括上传文件上传到云服务器，再一个我们也对服务器进行了一个本地的缓存，那么我们在开发这些功能的时候，我们基于这样的一些技术，包括cat可以做定时任务，包括咖啡因可以做本地的缓存。

这里咖啡因又画了一个下划线，表示说在众多技术当中它也算是比较重要，因为它能解决缓存的问题，它能够提高我们整个应用的性能。

另外因为它是本地缓存，它在分布式部署的时候它有一定的局限性，你得知道对吧？所以说你要把它和release结合在一起去做一个回顾。然后从业务层面，我们在这里面重点还要去关注线程池，其实就是class它背后的一些原则形成时，然后关注缓存这两个话题。好了，以上是我对整个我们这个项目从技术到这个业务所做的一个总结。

那么还是那句话，就是说我只是大概的帮你梳理一下我们整个的思路，帮你画一画我们整个开发的这些功能所学的这些技术当中的一些关键点和重点，然后让你在复习的时候能够找到一个这个切入点，能够抓住重点去复习去回顾。

而我们每一项内容，我们在课堂上都已经做了很大篇幅的讲解和演示，所以课上我现在我不再跟你再讲一遍了，因为太浪费时间也没有必要好了。这个是我们从业务从技术的角度来说去对这个项目做的一个回顾，我们理解了技术和业务他们之间的一个应用场景，这就说完了。

说完以后其实还不够全面，我再补充一个，我们再换个角度，我们从一个运维的角度，我们整体的了解这个网站架构，这样的话可能你会对这个项目理解的更好一些，更透彻一些。当然有人说从运维角度，那不就是把它部署以后，那个角度你上次课不是已经部署过了吗？我上次课确实是部署过了，但是我上次课是采用一台服务器去部署的，对吧？然后每一个服务我只部署了一个节点，为什么？因为我们资源有限对吧？不可能说那么浪费，搞那么多服务器部署那么多节点没做不到，那么这次课我给大家画一个图给你，演示一下我们在真实的环境下，真实的情况下，我们到底是怎么部署的？

哪个服务它到底是部署了多少个节点，它们之间到底是一个怎么样的关系，把说说的再透彻一点。

你从一个更宏观的角度，从一个网站的角度，而不是从这个代码的角度再去看待这件事儿。那么可能是怎么说你理解了这件事以后，可能你就会理解面试官他所关注什么，你就更能够理解我所画的这些重点都在哪，为什么是这些是重点。好了，要了解网站整体架构，我给大家画一个图，现画提前没有画好。好，首先我们先从这个客户端开始说起，就是我们客户端要访问这个网站，那么我们这个网站去怎么去处理这个请求，然后他一步一步需要调用谁，我们再往后再去演化。

好，首先我先画一个方块，这方面代表客户端，这个客户端它未必是浏览器，也可能是APP对吧？所以说我这里就统称叫客户端。好这是客户端，然后客户端它向这个服务器发请求，其实请求分为两类，一类他请求的是静态资源，像什么css文件，js文件图片这是静态资源，不会有任何变化。

一类是动态请求访问的是controller，要求返回动态数据。那么这两者这两种请求，我们其实在服务端部署的时候，是由不同的服务器去处理的。

好静态和动态，其实我们可以从牛客网去看一下，拿code的卡，咱们就以 Logo为例，右键检查，logo它是一个超链接，超链接你看对应的这个是有一个样式声明，超链接的背景图片，你看这个图片叫static点脑壳的.com，他是从时代脑壳的.com域名得到的数据，然后的话我们整个网页是脑壳的.com，就是说我们网页和我们网页中所包含的静态资源，它是两个域名或者说它是两个服务器返回的，为什么要搞两个服务器？

其实是为了性能，你要理解好，我就把这个画一下。

首先我先说一下我们的动态资源，是我们服务端部署的 ndx去处理的，因为我们上次都不说了，我们部署的时候是在应用服务器之前部署了一个部署了 ndx然后 ndx可以对服务器做反向代理，如果你有多个服务器它还能做负载均衡，对吧？是这样的。

好，所以说我们在服务器是部署了 ndx然后 ndx其实通常情况下我们会部署两台，部署两个，一个是组，一个是从平时是组服务器处理客户端请求从服务器只是起到一个备份的作用，万一某一刻主服务器挂了，从服务器顶上他是这个意思。

是为了就怕它主服务器发一台服务器挂掉，如果单节点挂掉那就糟糕了，所以说就是部署一个组一个从那只有写上恩杰克斯主，再来一个ndx从。

好，那么当然了我们默认情况下，如果他没挂掉的话，我们肯定是把请求发给 n这个是主服务器，他俩其实就是形成了一个小的集群了，好，然后这是动态请求，如果是静态请求不发给他，不由他处理，我们是把静态资源部署到了 cdn的上面去。

就cda缓存服务上面，你这个缓存服务你可以买，比如说阿里云买，然后它的好处是因为缓存服务的提供商，他在全国各地都有这个服务器，那么你把静态资源发给他以后，他会把静态资源部署到全国各地的服务器上去，然后我们用户如果去cdn上加载一个资源的话，它会就近加载，全国都有服务器就近加载，这样速度就快了。

所以为什么我们要把静态资源部署到第三方的服务器上去，因为它有得天独厚的一个优势，这里我就画了三份，比如说这个是多个，其实是更多的，我只画三个表示任意多个，所以你看我们在一开始处理资源的时候，就有这样的一个巧妙的办法，这是为了提高性能。

好了，那么所有的动态请求都发给了 ngx服务器以后， ngx它是起到了一个负载均衡的作用，那么它会当你把请求分发给某一个应用服务器，好，那么应用服务器我们在真实的部署的时候一定是多台，除非你这个网非常小，只要稍有规模一定是多台，我们这里是多台多个server，我也是画三个表示任意多个server，我们这个server里部署了什么，我们就部署了我们的项目代码，对吧？

我们的项目代码是什么呢？Community当然我们实际是把它改名为 root，但是我们还是按照这个业务名来来说，要不然感觉别扭肯定没问题，这是一个。

再一个我们 server里还还有本地缓存，因为我们通过代码给它分配了一一些缓存，本地缓存就缓存，因为我们画在server上自然就是server本地的这样一个缓存，就这样。

好，然后 n这个字我们访问它以后，它会把请求分发给某众多server中的一个按照一定的算法去分发的，比如说就发给了 Siri，调用了它里边的事先部署好的代码，这个代码首先它会如果你访问数据，我们是用到了缓存，它就会上缓存里去找，看有没有这个数据，它会访问本地的缓存，他不会访问别的思路的缓存，所以他们之间是这样一个关系，再往后然后我们除了 Siri以外，Siri要调的东西很多，我们还部署了数据库对吧？

那么他几乎所有的数据来源都是数据库，买circle我们通常是部署了两台这个叫DB然后往往是要做读写分离的，就是一台数据库负责只负责读，一台数据库只负责写，他们的分工是非常的明确，这是通常的一个做法， r但是读 dbr表示读，再来一个dbw表示写。

实际上是这样的就是说如果说我这个server里的代码访问这个数据库，如果是要写的话，他就会访问写入数据的DB，然后写入数据的DB会把数据写入以后会同步到读取的数据库里，然后我们在获取数据的时候是从数据库里取，总之只往这里写，只从这里读，是这样一个一个逻辑。

好，这是数据库的一个部署的情况，读写分离，这样的话既有备份，然后的话效率也会高，你只往一台数据库里只写，这个数据库只读，那么效率会高一些高很多。

好了，当然了我们应用还会访问的是 radios，那么radios我们可以部署任意多个做一个集群，好所以这个ready是多份，当然了我们ready其实也是起到一个缓存的作用，那么我们本地有缓存rdc也有缓存，其实这是形成了一个二级缓存了，那么本地缓存有直接返回本地缓存没有看一下ready是有没有，如果有返回效率还是高的，实际上没有再去访问数据库，这样的话避免最大程度的避免请求直接访问数据库，大大的提高了效率好。

然后我们还部署了卡夫卡，那卡夫卡其实在应用当中其实也可以部署任意多个，当然了这个server也可以访问其中的某一个来获取相关的数据，然后我们还部署了什么搜索引擎服务器us take search，这个其实也是可以部署 n多个服务器访问其中某一个，搜索到相关的数据就可以了。

那么总而言之就是这些服务这样去部署，他能都是为了能够尽可能保证的高性能以及高可用，有一台服务挂了，另一台服务器顶上，那么为什么数据库我们只部署两个，没有部署那么多个，因为数据库如果说你跟他们一样做分布式部署的话，那么就要去处理分布式的事物，这个是比较麻烦的。

所以说一般我们尽量避免这种情况，而且通常的话我们业务没有大到那种级别，说需要一定需要做分布式部署，因为你看所有的很多数据，我们都可以从缓存里取，其实从他这里取数据的几率就大大的降低了。

所以按照读写分离的方式已经能够满足绝大部分情况的需要了，就没有必要去做那种集群式就部署了。

当然了还有一个除了这些以外，我们还有一个文件服务器，有人说我没部署文件服务器，其实不用你部署，因为我们文件服务器用的是第三方，我们用的是七牛云，对吧？七牛云也是云服务，它也是有多个服务器的，我们是将数据存到了某一个服务器上，然后从这个服务器去获取，是这样一个关系。

好了，我们最终的部署的方案就是这样的。

这里边 Nds主从数据库读写分离两台，那么其他的每一个服务包括server文件服务器，瑞丽斯卡夫卡一来是txt，甚至cdn都是任意多台，具体是多少就看你的业务量，可能我们最初部署两个，有一个备份就可以了，后来业务发生变化，就是数据量大，再加一个不够再加一个，这就是慢慢演化的一个过程，每个网站都不一样，所以这个没有一个固定的数量，但是我告诉你这些地方可以部署任意多个，所以你看作为网站的建设者，或者说作为你的作为面试官，他要考虑的是这样的一个全盘的问题，他不只要考虑说我这个代码怎么写的问题，他更关注的是这个网站能不能正常的运转起来，能不能很性能很高的运转起来，能不能某一个服务器挂了，我还能够提供继续提供服务，而不至于让整个网站瘫掉，所以他最关注的什么问题？

第一个是性能问题，第二个是可靠性的问题，以及安全的问题，这些是他非常关注的。至于说你把这个功能实现了，把代码写出来，这只是一个最基本的要求，这只是我们建设网站的第一步而已，是吧？所以说那么你再回顾一下我刚才说给你画的那些重点，对吧？其实都是落在了性能上，落在安全这些方面。所以说你在回顾的时候，你把功能层面的你自然是要掌握这些方面，提高性能方面，提高安全性的方面的内容，你是尤为要重点来关注。

好了，现在我已经从技术的角度，从运维的角度给你介绍了，回顾了我们整个项目的一些内容，最后我再给大家一些建议，你准备面试的时候，你怎么去准备这方面的建议？我是从面试官他要考察的内容的层面给你一些意见，那么你要知道就是面试官他面试你，他希望考察你的什么内容什么方面，我总结的是三个方面，第一个方面面试官想看看你的职业素养，看你能不能具备作为一个程序员的基本素质，这个主要是看你的数据结构算法，看你的基础。

这些内容其实只要是计算机或者是相关专业的，基本上大学我们都学了。说白了面试官想看看什么，他想看看你你大学的时候你是在打游戏搞对象，你还在真的在学习，他当然想找一个真真正正扎扎实实在学习的人，这是他的一个目的。

好，第二个面试官想考察你的一个项目经验，看看你当前你掌握的技能的栈技术栈全不全面，你来到我这个项目组以后，你能不能直接胜任我要求的这份工作？说白了我希望你来了就能干活，而不是说我得找个人带你对吧？因为我找个人带你，你得拖那个人后腿，你整天问他问他拖那人后腿，哪怕就说你不要工资，你也会拖他后腿，他的效率就低了，对吧？是这样一个逻辑。

而你来了就能干活，你就少拖人家后腿，我说这是我们想要的。然后如果说你的职业素养ok，你的项目经验也不错，那么你这两个方面已经传达给面试官以后，你基本上成功的概率就很大了。

但是还有一种情况就是说万一有多个入围者，基本素质都ok，项目经验也都差不多，这时候怎么办？面试官还要看你第三个能力，就是你的钻研能力，他想看看你的长板而不是短板，也就是说你最擅长的领域是什么水平？

我想观察一下你的专业能力，你的独立解决问题的能力，所以往往面试官在面试的时候，他会经挑你就说你说你哪熟我就问你，我问的尽可能的深，我看你到底水平有多深，就挖到你的底为止，我看你的底到底有多深，为什么想看你的长板？

它背后的逻辑是什么？就是说还是我希望你来了，虽然说你的技能站ok，你能干这个活，但是你干活的时候你肯定会遇到各种各样的问题，我希望你遇到问题的时候，你能独立自主的解决问题，你不要来问我，或者你少来问我，因为我很忙，还是还是这个方面的问题，就是你们不要拖人后腿。

如果说你的长班很长，比方说你的专业能力足够，你平时遇到的问题基本上都能解决，很少会问我，然后哪怕将来有一天说我需要用到引入一个新的技术来解决项目的问题，我让你去研究一下，你也能搞得定，你的对团队的提高价值大了去了。

所以我建议大家从职业素养方面，你的数据结构算法你还是得复习，当然我们这个课不是解决这方面的问题，这个是靠你自己去复习。

第二个项目经验，我们这个项目给你带来了一个我觉得比较可观的一个项目经验了，只要你把它搞扎实了就够了。

然后第三个专业能力，你得看你自己了，我们有这么多个方面，你可以挑某一个领域某一个方面你做一个深入的学习和研究，你比如说我仔细研究rise，比如说我就仔细研究数据库的读写分离，我就深入研究一下 Nx等等，你想要什么都行，当然我去研究使用源码，对吧？

我去研究是不认识快乐，我去研究一级缓存，我去研究Tom cat都可以。

好了，当然了我们不要贪多，就是说你把一个研究透了，研究得非常到位，长板显得非常长，你的专业能力非常的突出，这就够了。然后比如说我研究这俩然后都一般般要好，所以说你挑一个研究的足够透彻，这个是我所建议的。好了，那么这次课我们就从这么几个方面给大家做了一个项目的总结，然后总结完以后只是指导你去做一个复习，希望大家能够按照我的这些个一些指引，你去把你的复习的工作做好。好，我们这次课就讲到这里，咱们下次课再见。